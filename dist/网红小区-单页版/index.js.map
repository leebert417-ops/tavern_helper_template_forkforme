{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_96d39c74a8c06e57a334244d199e36ff/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/src/网红小区-单页版/initialData.ts","src://tavern_helper_template/src/网红小区-单页版/gameStore.ts","webpack://tavern_helper_template/./src/网红小区-单页版/components/ActionPanel.vue?9e43","webpack://tavern_helper_template/src/网红小区-单页版/components/ActionPanel.vue?94b9","webpack://tavern_helper_template/./src/网红小区-单页版/components/InventoryPage.vue?ea8e","webpack://tavern_helper_template/src/网红小区-单页版/components/InventoryPage.vue?76f7","src://tavern_helper_template/external var \"_\"","webpack://tavern_helper_template/./src/网红小区-单页版/components/RoomDetailModal.vue?8ee3","webpack://tavern_helper_template/src/网红小区-单页版/components/RoomDetailModal.vue?66a0","webpack://tavern_helper_template/./src/网红小区-单页版/components/MapView.vue?377f","webpack://tavern_helper_template/src/网红小区-单页版/components/MapView.vue?9f47","webpack://tavern_helper_template/./src/网红小区-单页版/components/NarrativeWindow.vue?cfdc","webpack://tavern_helper_template/src/网红小区-单页版/components/NarrativeWindow.vue?a725","webpack://tavern_helper_template/./src/网红小区-单页版/components/ProfilePage.vue?2a8e","webpack://tavern_helper_template/src/网红小区-单页版/components/ProfilePage.vue?b679","webpack://tavern_helper_template/./src/网红小区-单页版/App.vue?651c","webpack://tavern_helper_template/src/网红小区-单页版/App.vue?9adc","src://tavern_helper_template/src/网红小区-单页版/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","/**\n * 本文件包含了从“网红小区”原始设定文件 `变量初始化.xyaml` 中提取的初始游戏状态。\n * 这使得我们的游戏状态管理与原始数据分离，更易于维护。\n */\n\nexport const initialWorldState = {\n  年份: \"2025年\",\n  日期: \"10月28日\",\n  星期: \"星期二\",\n  时间: \"08:00\",\n  地点: \"东海市·荟萃城\",\n};\n\nexport const initialApartmentsState = {\n  楼层配置: {\n    三楼: { 显示名称: \"三楼\", 顺序: 3 },\n    二楼: { 显示名称: \"二楼\", 顺序: 2 },\n    一楼: { 显示名称: \"一楼\", 顺序: 1 },\n  },\n  房间列表: {\n    \"101\": { 类型: \"公共客厅\", 名称: \"101\", 描述: \"公共客厅，配备会客区和用餐区，免费对所有租客开放\", 布局: { 楼层: \"一楼\", 位置: \"A区\" }, 功能区: \"会客区、用餐区\" },\n    \"102\": { 类型: \"公共客厅\", 名称: \"102\", 描述: \"公共客厅，配备休息区和娱乐区，免费对所有租客开放\", 布局: { 楼层: \"一楼\", 位置: \"B区\" }, 功能区: \"休息区、娱乐区\" },\n    \"103\": { 类型: \"健身房\", 名称: \"103\", 描述: \"公共健身房，配备健身设备和瑜伽区，免费对所有租客开放\", 布局: { 楼层: \"一楼\", 位置: \"C区\" }, 功能区: \"健身设备区、瑜伽区\" },\n    \"104\": { 类型: \"健身房\", 名称: \"104\", 描述: \"公共健身房舞蹈区和洗衣间，免费对所有租客开放\", 布局: { 楼层: \"一楼\", 位置: \"D区\" }, 功能区: \"舞蹈区、洗衣设备\" },\n    \"201\": { 类型: \"套间\", 名称: \"201\", 住户: \"未知\", 描述: \"一室一厅一卫一厨，35-50㎡个人公寓\", 布局: { 楼层: \"二楼\", 位置: \"A区\" } },\n    \"202\": { 类型: \"套间\", 名称: \"202\", 住户: \"未知\", 描述: \"一室一厅一卫一厨，35-50㎡个人公寓\", 布局: { 楼层: \"二楼\", 位置: \"B区\" } },\n    \"203\": { 类型: \"您的房间\", 名称: \"203\", 住户: \"<user>\", 描述: \"一室一厅一卫一厨，房东自住公寓\", 布局: { 楼层: \"二楼\", 位置: \"C区\" } },\n    \"204\": { 类型: \"洗衣间\", 名称: \"204\", 描述: \"公共洗衣间，配备洗衣机和烘干机，免费对所有租客开放\", 布局: { 楼层: \"二楼\", 位置: \"D区\" }, 功能区: \"洗衣设备、烘干设备\" },\n    \"301\": { 类型: \"套间\", 名称: \"301\", 住户: \"未知\", 描述: \"一室一厅一卫一厨，35-50㎡个人公寓\", 布局: { 楼层: \"三楼\", 位置: \"A区\" } },\n    \"302\": { 类型: \"套间\", 名称: \"302\", 住户: \"未知\", 描述: \"一室一厅一卫一厨，35-50㎡个人公寓\", 布局: { 楼层: \"三楼\", 位置: \"B区\" } },\n    \"303\": { 类型: \"套间\", 名称: \"303\", 住户: \"未知\", 描述: \"一室一厅一卫一厨，35-50㎡个人公寓\", 布局: { 楼层: \"三楼\", 位置: \"C区\" } },\n    \"304\": { 类型: \"洗衣间\", 名称: \"304\", 描述: \"公共洗衣间，配备洗衣机和烘干机，免费对所有租客开放\", 布局: { 楼层: \"三楼\", 位置: \"D区\" }, 功能区: \"洗衣设备、烘干设备\" },\n  },\n};\n\n/**\n * 日程表类型定义\n * 每个时间段指定租客应该在哪个位置\n */\nexport interface ScheduleEntry {\n  /** 开始时间，格式：HH:MM */\n  startTime: string;\n  /** 结束时间，格式：HH:MM */\n  endTime: string;\n  /** 该时间段应该在的位置（房间号） */\n  location: string;\n  /** 该时间段在做什么（可选，用于未来的叙事描述） */\n  activity?: string;\n}\n\n/**\n * 租客数据接口\n */\nexport interface Tenant {\n  年龄: number;\n  外貌: string;\n  职业: string;\n  性格: string;\n  恋情: string;\n  内心: string;\n  状态: string;\n  穿搭: string;\n  好感度: number;\n  性欲: number;\n  入住日期: string;\n  入住天数: number;\n  当前位置: string;\n  创作内容: string;\n  关系: Record<string, string>;\n  /** 日程表：定义租客在一天中不同时间段的位置 */\n  schedule: ScheduleEntry[];\n}\n\n// 初始租客状态，包含两个示例租客\nexport const initialTenantsState: Record<string, Tenant> = {\n  \"林悦\": {\n    年龄: 24,\n    外貌: \"清秀甜美的面容，身材苗条，腰细腿长。留着齐肩的黑色短发，皮肤白皙，眼神清澈明亮。胸部B罩杯，臀部紧致有型。\",\n    职业: \"舞蹈博主\",\n    性格: \"开朗、活泼、自律、热爱生活\",\n    恋情: \"单身\",\n    内心: \"想通过努力成为知名舞蹈博主\",\n    状态: \"刚刚起床，正在洗漱\",\n    穿搭: \"粉色运动背心和黑色瑜伽裤\",\n    好感度: 50,\n    性欲: 20,\n    入住日期: \"10月1日\",\n    入住天数: 27,\n    当前位置: \"201\",\n    创作内容: \"舞蹈教学视频、日常跳舞vlog\",\n    关系: {\n      \"<user>\": \"房东\"\n    },\n    schedule: [\n      { startTime: \"06:00\", endTime: \"08:00\", location: \"201\", activity: \"起床、洗漱、准备\" },\n      { startTime: \"08:00\", endTime: \"09:00\", location: \"101\", activity: \"早餐\" },\n      { startTime: \"09:00\", endTime: \"11:00\", location: \"104\", activity: \"舞蹈练习\" },\n      { startTime: \"11:00\", endTime: \"13:00\", location: \"201\", activity: \"休息、拍摄视频\" },\n      { startTime: \"13:00\", endTime: \"14:00\", location: \"101\", activity: \"午餐\" },\n      { startTime: \"14:00\", endTime: \"17:00\", location: \"201\", activity: \"剪辑视频、直播\" },\n      { startTime: \"17:00\", endTime: \"19:00\", location: \"104\", activity: \"晚间舞蹈练习\" },\n      { startTime: \"19:00\", endTime: \"20:00\", location: \"101\", activity: \"晚餐\" },\n      { startTime: \"20:00\", endTime: \"22:00\", location: \"102\", activity: \"放松娱乐\" },\n      { startTime: \"22:00\", endTime: \"06:00\", location: \"201\", activity: \"洗澡、睡觉\" },\n    ]\n  },\n  \"苏婉\": {\n    年龄: 26,\n    外貌: \"成熟知性的气质，身材高挑匀称，长发披肩。五官精致，眼神温柔。胸部C罩杯，体态优雅。\",\n    职业: \"健身博主\",\n    性格: \"自律、友善、专业、温和\",\n    恋情: \"单身\",\n    内心: \"希望帮助更多人建立健康的生活方式\",\n    状态: \"正在健身房进行晨练\",\n    穿搭: \"黑色运动紧身衣和灰色运动短裤\",\n    好感度: 50,\n    性欲: 15,\n    入住日期: \"10月5日\",\n    入住天数: 23,\n    当前位置: \"103\",\n    创作内容: \"健身教程、营养指导、身材管理\",\n    关系: {\n      \"<user>\": \"房东\"\n    },\n    schedule: [\n      { startTime: \"05:30\", endTime: \"07:00\", location: \"103\", activity: \"晨练\" },\n      { startTime: \"07:00\", endTime: \"08:00\", location: \"302\", activity: \"洗澡、准备\" },\n      { startTime: \"08:00\", endTime: \"09:00\", location: \"101\", activity: \"健康早餐\" },\n      { startTime: \"09:00\", endTime: \"12:00\", location: \"302\", activity: \"拍摄健身教程\" },\n      { startTime: \"12:00\", endTime: \"13:00\", location: \"101\", activity: \"午餐\" },\n      { startTime: \"13:00\", endTime: \"15:00\", location: \"302\", activity: \"休息、剪辑视频\" },\n      { startTime: \"15:00\", endTime: \"17:00\", location: \"103\", activity: \"下午训练课\" },\n      { startTime: \"17:00\", endTime: \"18:00\", location: \"302\", activity: \"洗澡、整理\" },\n      { startTime: \"18:00\", endTime: \"19:00\", location: \"101\", activity: \"晚餐\" },\n      { startTime: \"19:00\", endTime: \"21:00\", location: \"302\", activity: \"直播、互动\" },\n      { startTime: \"21:00\", endTime: \"22:00\", location: \"102\", activity: \"放松、社交\" },\n      { startTime: \"22:00\", endTime: \"05:30\", location: \"302\", activity: \"睡眠\" },\n    ]\n  }\n};\n","import { klona } from 'klona/lite';\nimport { defineStore } from 'pinia';\nimport { readonly, ref } from 'vue';\nimport { initialApartmentsState, initialTenantsState, initialWorldState, type ScheduleEntry } from './initialData';\n\n// ========== 类型定义 ==========\n\n// 敘事訊息的結構\nexport interface NarrativeMessage {\n  id: number;\n  type: 'system' | 'action' | 'dialogue' | 'event';\n  text: string;\n  timestamp: string; // 记录消息发生时的游戏时间\n}\n\n// 假設的 MvuData 結構 (基於 mvu.d.ts)\n// 我們主要關心 stat_data\ninterface MvuData {\n  stat_data: Record<string, any>;\n  display_data?: Record<string, any>;\n  delta_data?: Record<string, any>;\n  initialized_lorebooks?: string[];\n}\n\n// ========== 時間處理輔助函數 ==========\n\n/**\n * 解析時間字符串為分鐘數（從 00:00 開始算）\n * @param timeStr - 時間字符串，格式：HH:MM\n * @returns 從 00:00 開始的總分鐘數\n */\nfunction parseTime(timeStr: string): number {\n  const [hours, minutes] = timeStr.split(':').map(Number);\n  return hours * 60 + minutes;\n}\n\n/**\n * 將分鐘數格式化為時間字符串\n * @param minutes - 從 00:00 開始的總分鐘數\n * @returns 格式化的時間字符串 HH:MM\n */\nfunction formatTime(minutes: number): string {\n  // 處理跨天情況（分鐘數可能 >= 1440）\n  const totalMinutes = minutes % 1440; // 1440 = 24 * 60\n  const hours = Math.floor(totalMinutes / 60);\n  const mins = totalMinutes % 60;\n  return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;\n}\n\n/**\n * 給時間字符串增加指定的小時數\n * @param timeStr - 時間字符串，格式：HH:MM\n * @param hours - 要增加的小時數\n * @returns 新的時間字符串\n */\nfunction addHours(timeStr: string, hours: number): string {\n  const minutes = parseTime(timeStr);\n  const newMinutes = minutes + hours * 60;\n  return formatTime(newMinutes);\n}\n\n/**\n * 檢查當前時間是否在某個時間段內\n * @param currentTime - 當前時間字符串 HH:MM\n * @param startTime - 時間段開始時間 HH:MM\n * @param endTime - 時間段結束時間 HH:MM\n * @returns 是否在時間段內\n */\nfunction isTimeInRange(currentTime: string, startTime: string, endTime: string): boolean {\n  const current = parseTime(currentTime);\n  const start = parseTime(startTime);\n  let end = parseTime(endTime);\n\n  // 處理跨天的情況（如 22:00 到次日 06:00）\n  if (end <= start) {\n    end += 1440; // 加上 24 小時\n    // 如果當前時間小于開始時間，說明當前時間是第二天的\n    if (current < start) {\n      return current <= end - 1440;\n    }\n  }\n\n  return current >= start && current < end;\n}\n\n/**\n * 根據當前時間和日程表，查找租客應該在的位置\n * @param currentTime - 當前時間字符串 HH:MM\n * @param schedule - 租客的日程表\n * @returns 應該在的位置（房間號），如果沒有匹配則返回 null\n */\nfunction findLocationByTime(currentTime: string, schedule: ScheduleEntry[]): string | null {\n  for (const entry of schedule) {\n    if (isTimeInRange(currentTime, entry.startTime, entry.endTime)) {\n      return entry.location;\n    }\n  }\n  return null;\n}\n\nexport const useGameStore = defineStore('game', () => {\n  // --- 狀態定義 ---\n  // 使用從 initialData.ts 導入的數據來初始化狀態\n  const world = ref(initialWorldState);\n  const apartments = ref(initialApartmentsState);\n  const tenants = ref(initialTenantsState);\n\n  // --- 玩家狀態 ---\n  const player = ref({\n    currentLocation: '203', // 默認為玩家自己的房間\n    inventory: [] as Array<{\n      name: string;\n      type: string;\n      description?: string;\n      effect?: string;\n      quantity?: number;\n      usable?: boolean;\n    }>,\n  });\n\n  // --- 敘事和加載狀態 ---\n  const narrativeLog = ref<NarrativeMessage[]>([]);\n  const isLoading = ref(false);\n  let messageIdCounter = ref(0);\n\n  // --- 輔助函數 ---\n  /**\n   * 向敘事日誌添加一條新消息\n   * @param type 消息類型\n   * @param text 消息文本\n   */\n  function addNarrativeMessage(type: NarrativeMessage['type'], text: string) {\n    narrativeLog.value.push({\n      id: messageIdCounter.value++,\n      type,\n      text,\n      timestamp: world.value.时间,\n    });\n  }\n\n  /**\n   * 遊戲核心循環: 推進時間並更新世界狀態\n   * @param hours - 要推進的小時數\n   */\n  function advanceTime(hours: number) {\n    if (isLoading.value) return; // 避免在等待 LLM 回應時推進時間\n\n    console.log(`推進時間 ${hours} 小時...`);\n\n    // 1. 更新世界時間\n    const currentTime = world.value.时间;\n    const newTime = addHours(currentTime, hours);\n    world.value.时间 = newTime;\n\n    addNarrativeMessage('system', `時間推進了 ${hours} 小時, 現在是 ${newTime}。`);\n    console.log(`時間從 ${currentTime} 推進到 ${newTime}`);\n\n    // 2. 根據日程更新所有租客的位置\n    for (const [tenantName, tenant] of Object.entries(tenants.value)) {\n      const newLocation = findLocationByTime(newTime, tenant.schedule);\n\n      if (newLocation && newLocation !== tenant.当前位置) {\n        const oldLocation = tenant.当前位置;\n        tenant.当前位置 = newLocation;\n        console.log(`${tenantName} 從 ${oldLocation} 移動到 ${newLocation}`);\n        addNarrativeMessage('system', `${tenantName} 從 ${oldLocation} 移動到了 ${newLocation}。`);\n\n        // 可選：更新租客的狀態描述\n        const scheduleEntry = tenant.schedule.find(entry => isTimeInRange(newTime, entry.startTime, entry.endTime));\n        if (scheduleEntry && scheduleEntry.activity) {\n          tenant.状态 = scheduleEntry.activity;\n        }\n      } else if (newLocation) {\n        console.log(`${tenantName} 仍在 ${newLocation}`);\n      }\n    }\n\n    // 3. TODO: 檢查並觸發事件\n  }\n\n  /**\n   * 玩家移動到新房間\n   * @param roomId 房間 ID\n   */\n  function moveToRoom(roomId: string) {\n    if (isLoading.value) return;\n    if (player.value.currentLocation === roomId) return;\n\n    player.value.currentLocation = roomId;\n    const room = (apartments.value.房间列表 as any)[roomId];\n    addNarrativeMessage('action', `你移動到了 ${roomId} (${room.类型})。`);\n    console.log(`移動到房間: ${roomId}`);\n  }\n\n  /**\n   * 清空敘事日誌\n   */\n  function clearNarrativeLog() {\n    narrativeLog.value = [];\n    addNarrativeMessage('system', '歡迎來到網紅小區。');\n  }\n\n  /**\n   * 與租客互動 (Phase 5 核心實現)\n   * @param tenantId - 要互動的租客ID\n   */\n  async function interactWithTenant(tenantId: string) {\n    if (isLoading.value) {\n      console.warn('正在等待上一個互動完成...');\n      return;\n    }\n\n    isLoading.value = true;\n    console.log(`[Phase 5] 開始與 ${tenantId} 互動...`);\n\n    try {\n      const tenant = (tenants.value as any)[tenantId];\n      const room = (apartments.value.房间列表 as any)[player.value.currentLocation];\n\n      // 1. 等待 Mvu 初始化\n      await waitGlobalInitialized('Mvu');\n\n      // 2. 獲取當前 MvuData (使用 Pinia $state 作為 stat_data 的來源)\n      const oldMvuData: MvuData = {\n        stat_data: klona(useGameStore().$state),\n        display_data: {},\n        delta_data: {},\n        initialized_lorebooks: [],\n      };\n\n      // 3. 構建增強的 Prompt\n      const prompt = `你正在扮演一个模拟经营游戏的叙事引擎。玩家是一位公寓房东，正在与租客互动。\n\n[当前游戏状态]\n时间: ${world.value.时间}\n地点: ${player.value.currentLocation} (${room.类型})\n房东正在与 ${tenantId} 互动\n\n[租客 ${tenantId} 的信息]\n职业: ${tenant.职业}\n性格: ${tenant.性格}\n当前状态: ${tenant.状态}\n好感度: ${tenant.好感度}/100\n当前位置: ${tenant.当前位置}\n\n[互动规则]\n1. 好感度变化：\n   - 普通友好互动：+3 到 +5\n   - 深入交谈、帮助租客：+5 到 +10\n   - 送礼物、完成请求：+8 到 +15\n   - 冷淡、拒绝：-3 到 -8\n\n2. 状态更新：反映租客当前正在做的事情\n\n3. 记忆添加：仅在重要或有意义的互动后添加（10-20字）\n\n[任务]\n生成一段简短的互动叙事（50-100字），描述房东与 ${tenantId} 的对话或互动场景。\n然后使用 MVU 指令更新游戏状态。\n\n[输出格式]\n叙事文本...\n\n<UpdateVariable>\n  <Analysis>\n    tenants.${tenantId}.好感度: Yes/No\n    tenants.${tenantId}.状态: Yes/No\n    tenants.${tenantId}.记忆: Yes/No\n  </Analysis>\n  _.add('tenants.${tenantId}.好感度', X); // 原因\n  _.set('tenants.${tenantId}.状态', '旧状态', '新状态'); // 原因\n  _.insert('tenants.${tenantId}.记忆', '记忆内容'); // 原因\n</UpdateVariable>\n\n请开始生成：`;\n\n      addNarrativeMessage('action', `你开始与 ${tenantId} 互动...`);\n      console.log('[Phase 5] 调用 generate()...');\n\n      // 4. 调用 generate()\n      const llmResponse = await generate(prompt, {\n        max_tokens: 400,\n        temperature: 0.8,\n      });\n\n      console.log('[Phase 5] 收到 LLM 回应:', llmResponse);\n\n      // 5. 提取叙事文本\n      const mvuRegex = /<UpdateVariable>[\\s\\S]*?<\\/UpdateVariable>/g;\n      const narrativeText = llmResponse.replace(mvuRegex, '').trim();\n\n      if (narrativeText) {\n        addNarrativeMessage('dialogue', narrativeText);\n      }\n\n      // 6. 解析 MVU 指令\n      const newMvuData = await Mvu.parseMessage(llmResponse, oldMvuData as any);\n\n      // 7. 更新 store 状态\n      if (newMvuData && newMvuData.stat_data) {\n        console.log('[Phase 5] Mvu.parseMessage 解析成功，正在更新 Pinia 状态...');\n        useGameStore().$patch(newMvuData.stat_data);\n\n        // 显示变量变化\n        if (newMvuData.delta_data && Object.keys(newMvuData.delta_data).length > 0) {\n          for (const [key, change] of Object.entries(newMvuData.delta_data)) {\n            const friendlyKey = key\n              .replace('tenants.', '')\n              .replace('.好感度', ' 的好感度')\n              .replace('.状态', ' 的状态')\n              .replace('.记忆', ' 的记忆');\n            addNarrativeMessage('event', `📊 ${friendlyKey}: ${change}`);\n          }\n        }\n      } else {\n        console.warn('[Phase 5] Mvu.parseMessage 未返回新状态或未解析到指令。');\n        addNarrativeMessage('system', '(未检测到状态变化)');\n      }\n    } catch (error: any) {\n      console.error('[Phase 5] 互动时发生错误:', error);\n      addNarrativeMessage('system', `❌ 互动处理失败: ${error?.message || '未知错误'}`);\n    } finally {\n      isLoading.value = false;\n      console.log('[Phase 5] 互动结束。');\n    }\n  }\n\n  return {\n    world,\n    apartments,\n    tenants,\n    player,\n    narrativeLog: readonly(narrativeLog), // UI 只能讀取\n    isLoading: readonly(isLoading), // UI 只能讀取\n    advanceTime,\n    moveToRoom,\n    interactWithTenant,\n    clearNarrativeLog,\n    addNarrativeMessage, // 允許 App.vue 在 onMounted 時添加歡迎消息\n  };\n});\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"action-panel apt-card\" };\nconst _hoisted_2 = { class: \"apt-card-title\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"loading-indicator\"\n};\nconst _hoisted_4 = { class: \"apt-card-body custom-scrollbar\" };\nconst _hoisted_5 = { class: \"action-section\" };\nconst _hoisted_6 = { class: \"button-grid\" };\nconst _hoisted_7 = [\"disabled\"];\nconst _hoisted_8 = [\"disabled\"];\nconst _hoisted_9 = [\"disabled\"];\nconst _hoisted_10 = [\"disabled\"];\nimport { useGameStore } from '../gameStore';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ActionPanel',\n    setup(__props) {\n        const store = useGameStore();\n        // 推进时间\n        function advanceTime(hours) {\n            store.advanceTime(hours);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"span\", null, \"🎮\", -1 /* CACHED */)),\n                    _cache[5] || (_cache[5] = _createElementVNode(\"span\", null, \"行动面板\", -1 /* CACHED */)),\n                    (_unref(store).isLoading)\n                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \" (处理中...) \"))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[10] || (_cache[10] = _createElementVNode(\"div\", { class: \"section-title\" }, \"⏳ 时间控制\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _createElementVNode(\"button\", {\n                                class: \"apt-btn\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (advanceTime(1))),\n                                disabled: _unref(store).isLoading\n                            }, [...(_cache[6] || (_cache[6] = [\n                                    _createElementVNode(\"span\", { class: \"btn-icon\" }, \"⏩\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"推进 1 小时\", -1 /* CACHED */)\n                                ]))], 8 /* PROPS */, _hoisted_7),\n                            _createElementVNode(\"button\", {\n                                class: \"apt-btn\",\n                                onClick: _cache[1] || (_cache[1] = ($event) => (advanceTime(2))),\n                                disabled: _unref(store).isLoading\n                            }, [...(_cache[7] || (_cache[7] = [\n                                    _createElementVNode(\"span\", { class: \"btn-icon\" }, \"⏩⏩\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"推进 2 小时\", -1 /* CACHED */)\n                                ]))], 8 /* PROPS */, _hoisted_8),\n                            _createElementVNode(\"button\", {\n                                class: \"apt-btn\",\n                                onClick: _cache[2] || (_cache[2] = ($event) => (advanceTime(6))),\n                                disabled: _unref(store).isLoading\n                            }, [...(_cache[8] || (_cache[8] = [\n                                    _createElementVNode(\"span\", { class: \"btn-icon\" }, \"⏰\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"推进 6 小时\", -1 /* CACHED */)\n                                ]))], 8 /* PROPS */, _hoisted_9),\n                            _createElementVNode(\"button\", {\n                                class: \"apt-btn apt-btn-secondary\",\n                                onClick: _cache[3] || (_cache[3] = ($event) => (advanceTime(12))),\n                                disabled: _unref(store).isLoading\n                            }, [...(_cache[9] || (_cache[9] = [\n                                    _createElementVNode(\"span\", { class: \"btn-icon\" }, \"🌙\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"推进 12 小时\", -1 /* CACHED */)\n                                ]))], 8 /* PROPS */, _hoisted_10)\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ActionPanel.vue?vue&type=style&index=0&id=28591e35&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_96d39c74a8c06e57a334244d199e36ff/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-28591e35\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, createTextVNode as _createTextVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"inventory-page apt-card\" };\nconst _hoisted_2 = { class: \"apt-card-title\" };\nconst _hoisted_3 = { class: \"subtitle\" };\nconst _hoisted_4 = { class: \"apt-card-body custom-scrollbar\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"empty-inventory\"\n};\nconst _hoisted_6 = {\n    key: 1,\n    class: \"items-grid\"\n};\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = { class: \"item-icon\" };\nconst _hoisted_9 = { class: \"item-info\" };\nconst _hoisted_10 = { class: \"item-name\" };\nconst _hoisted_11 = { class: \"item-type\" };\nconst _hoisted_12 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_13 = { class: \"detail-panel\" };\nconst _hoisted_14 = { class: \"detail-header\" };\nconst _hoisted_15 = { class: \"detail-title\" };\nconst _hoisted_16 = { class: \"detail-icon\" };\nconst _hoisted_17 = { class: \"detail-body custom-scrollbar\" };\nconst _hoisted_18 = { class: \"item-details\" };\nconst _hoisted_19 = { class: \"detail-section\" };\nconst _hoisted_20 = { class: \"info-grid\" };\nconst _hoisted_21 = { class: \"info-item\" };\nconst _hoisted_22 = { class: \"info-value\" };\nconst _hoisted_23 = {\n    key: 0,\n    class: \"info-item\"\n};\nconst _hoisted_24 = { class: \"info-value highlight\" };\nconst _hoisted_25 = {\n    key: 0,\n    class: \"detail-section\"\n};\nconst _hoisted_26 = { class: \"item-description\" };\nconst _hoisted_27 = {\n    key: 1,\n    class: \"detail-section\"\n};\nconst _hoisted_28 = { class: \"item-effect\" };\nconst _hoisted_29 = { class: \"detail-footer\" };\nconst _hoisted_30 = [\"disabled\"];\nimport { computed, ref } from 'vue';\nimport { useGameStore } from '../gameStore';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryPage',\n    setup(__props) {\n        const store = useGameStore();\n        const selectedItem = ref(null);\n        const selectedItemIndex = ref(-1);\n        // 道具总数\n        const totalItems = computed(() => {\n            return store.player.inventory?.reduce((sum, item) => sum + (item.quantity || 1), 0) || 0;\n        });\n        // 选择道具\n        function selectItem(item, index) {\n            selectedItem.value = item;\n            selectedItemIndex.value = index;\n        }\n        // 关闭详情\n        function closeDetail() {\n            selectedItem.value = null;\n            selectedItemIndex.value = -1;\n        }\n        // 获取道具图标\n        function getItemIcon(type) {\n            const iconMap = {\n                食物: '🍱',\n                饮料: '🥤',\n                礼物: '🎁',\n                工具: '🔧',\n                钥匙: '🔑',\n                书籍: '📚',\n                装饰: '🎨',\n                电子产品: '📱',\n                化妆品: '💄',\n                衣物: '👔',\n                药品: '💊',\n                其他: '📦',\n            };\n            return iconMap[type] || '📦';\n        }\n        // 检查道具是否可用\n        function canUseItem(item) {\n            return item.usable !== false;\n        }\n        // 使用道具\n        function useItem() {\n            if (!selectedItem.value || !canUseItem(selectedItem.value))\n                return;\n            // TODO: 实现道具使用逻辑\n            alert(`使用了 ${selectedItem.value.name}！\\n功能开发中...`);\n            // 如果道具有数量，减少数量\n            if (selectedItem.value.quantity && selectedItem.value.quantity > 1) {\n                selectedItem.value.quantity--;\n            }\n            else {\n                // 移除道具\n                if (selectedItemIndex.value >= 0) {\n                    store.player.inventory.splice(selectedItemIndex.value, 1);\n                }\n            }\n            closeDetail();\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"span\", null, \"🎒\", -1 /* CACHED */)),\n                    _cache[1] || (_cache[1] = _createElementVNode(\"span\", null, \"背包\", -1 /* CACHED */)),\n                    _createElementVNode(\"span\", _hoisted_3, _toDisplayString(totalItems.value) + \" 件道具\", 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (totalItems.value === 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[2] || (_cache[2] = [\n                                _createElementVNode(\"div\", { class: \"empty-icon\" }, \"📦\", -1 /* CACHED */),\n                                _createElementVNode(\"div\", { class: \"empty-text\" }, \"背包空空如也\", -1 /* CACHED */),\n                                _createElementVNode(\"div\", { class: \"empty-hint\" }, \"探索公寓，收集道具吧！\", -1 /* CACHED */)\n                            ]))]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(store).player.inventory, (item, index) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: index,\n                                    class: \"item-card\",\n                                    onClick: ($event) => (selectItem(item, index))\n                                }, [\n                                    _createCommentVNode(\" 道具图标 \"),\n                                    _createElementVNode(\"div\", _hoisted_8, [\n                                        _createElementVNode(\"span\", null, _toDisplayString(getItemIcon(item.type)), 1 /* TEXT */)\n                                    ]),\n                                    _createCommentVNode(\" 道具信息 \"),\n                                    _createElementVNode(\"div\", _hoisted_9, [\n                                        _createElementVNode(\"div\", _hoisted_10, _toDisplayString(item.name), 1 /* TEXT */),\n                                        _createElementVNode(\"div\", _hoisted_11, _toDisplayString(item.type), 1 /* TEXT */)\n                                    ]),\n                                    _createCommentVNode(\" 道具数量 \"),\n                                    (item.quantity && item.quantity > 1)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \" ×\" + _toDisplayString(item.quantity), 1 /* TEXT */))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ], 8 /* PROPS */, _hoisted_7));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                ]),\n                _createCommentVNode(\" 道具详情弹窗 \"),\n                (selectedItem.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"detail-overlay\",\n                        onClick: _withModifiers(closeDetail, [\"self\"])\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_13, [\n                            _createElementVNode(\"div\", _hoisted_14, [\n                                _createElementVNode(\"h2\", _hoisted_15, [\n                                    _createElementVNode(\"span\", _hoisted_16, _toDisplayString(getItemIcon(selectedItem.value.type)), 1 /* TEXT */),\n                                    _createTextVNode(\" \" + _toDisplayString(selectedItem.value.name), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    onClick: closeDetail\n                                }, \"✕\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_17, [\n                                _createElementVNode(\"div\", _hoisted_18, [\n                                    _createCommentVNode(\" 基础信息 \"),\n                                    _createElementVNode(\"div\", _hoisted_19, [\n                                        _cache[5] || (_cache[5] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"📋 基础信息\", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_20, [\n                                            _createElementVNode(\"div\", _hoisted_21, [\n                                                _cache[3] || (_cache[3] = _createElementVNode(\"span\", { class: \"info-label\" }, \"类型：\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", _hoisted_22, _toDisplayString(selectedItem.value.type), 1 /* TEXT */)\n                                            ]),\n                                            (selectedItem.value.quantity && selectedItem.value.quantity > 1)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [\n                                                    _cache[4] || (_cache[4] = _createElementVNode(\"span\", { class: \"info-label\" }, \"数量：\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_24, \"×\" + _toDisplayString(selectedItem.value.quantity), 1 /* TEXT */)\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ])\n                                    ]),\n                                    _createCommentVNode(\" 道具描述 \"),\n                                    (selectedItem.value.description)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_25, [\n                                            _cache[6] || (_cache[6] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"📝 描述\", -1 /* CACHED */)),\n                                            _createElementVNode(\"p\", _hoisted_26, _toDisplayString(selectedItem.value.description), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    _createCommentVNode(\" 道具效果 \"),\n                                    (selectedItem.value.effect)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_27, [\n                                            _cache[7] || (_cache[7] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"✨ 效果\", -1 /* CACHED */)),\n                                            _createElementVNode(\"p\", _hoisted_28, _toDisplayString(selectedItem.value.effect), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_29, [\n                                _createElementVNode(\"button\", {\n                                    class: \"apt-btn apt-btn-secondary\",\n                                    onClick: closeDetail\n                                }, \"关闭\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"apt-btn\",\n                                    onClick: useItem,\n                                    disabled: !canUseItem(selectedItem.value)\n                                }, _toDisplayString(canUseItem(selectedItem.value) ? '使用' : '无法使用'), 9 /* TEXT, PROPS */, _hoisted_30)\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryPage.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryPage.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryPage.vue?vue&type=style&index=0&id=4dbef8e4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_96d39c74a8c06e57a334244d199e36ff/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4dbef8e4\"]])\n\nexport default __exports__","const __WEBPACK_NAMESPACE_OBJECT__ = _;","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, unref as _unref, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"modal-header\" };\nconst _hoisted_2 = { class: \"modal-title\" };\nconst _hoisted_3 = { class: \"modal-body custom-scrollbar\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"room-details\"\n};\nconst _hoisted_5 = { class: \"detail-section\" };\nconst _hoisted_6 = { class: \"info-grid\" };\nconst _hoisted_7 = { class: \"info-item\" };\nconst _hoisted_8 = { class: \"info-value\" };\nconst _hoisted_9 = { class: \"info-item\" };\nconst _hoisted_10 = { class: \"info-value\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"info-item\"\n};\nconst _hoisted_12 = { class: \"info-value highlight\" };\nconst _hoisted_13 = {\n    key: 1,\n    class: \"info-item full-width\"\n};\nconst _hoisted_14 = { class: \"info-value\" };\nconst _hoisted_15 = { class: \"detail-section\" };\nconst _hoisted_16 = {\n    key: 0,\n    class: \"occupants-grid\"\n};\nconst _hoisted_17 = [\"onClick\"];\nconst _hoisted_18 = { class: \"occupant-icon\" };\nconst _hoisted_19 = { class: \"occupant-name\" };\nconst _hoisted_20 = {\n    key: 1,\n    class: \"empty-message\"\n};\nconst _hoisted_21 = {\n    key: 0,\n    class: \"detail-section\"\n};\nconst _hoisted_22 = { class: \"room-description\" };\nconst _hoisted_23 = { class: \"modal-footer\" };\nconst _hoisted_24 = [\"disabled\"];\nconst _hoisted_25 = { key: 0 };\nconst _hoisted_26 = { key: 1 };\nconst _hoisted_27 = { class: \"interaction-panel\" };\nconst _hoisted_28 = { class: \"interaction-header\" };\nconst _hoisted_29 = { class: \"interaction-title\" };\nconst _hoisted_30 = { class: \"interaction-body\" };\nconst _hoisted_31 = { class: \"interaction-actions\" };\nimport { computed, ref } from 'vue';\nimport { useGameStore } from '../gameStore';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RoomDetailModal',\n    setup(__props, { expose: __expose }) {\n        const store = useGameStore();\n        const isVisible = ref(false);\n        const currentRoomGroup = ref(null);\n        const showInteractionPanel = ref(false);\n        const selectedTenant = ref('');\n        // 房间信息\n        const roomInfo = computed(() => currentRoomGroup.value);\n        // 当前在房间的人\n        const occupants = computed(() => {\n            if (!currentRoomGroup.value)\n                return [];\n            const people = [];\n            for (const roomId of currentRoomGroup.value.roomIds) {\n                // 检查玩家\n                if (store.player.currentLocation === roomId) {\n                    people.push({ name: '你', icon: '👤', isTenant: false });\n                }\n                // 检查租客\n                for (const [tenantName, tenant] of Object.entries(store.tenants)) {\n                    if (tenant.当前位置 === roomId) {\n                        people.push({ name: tenantName, icon: '👥', isTenant: true });\n                    }\n                }\n            }\n            return people;\n        });\n        // 是否是当前位置\n        const isCurrentLocation = computed(() => {\n            if (!currentRoomGroup.value)\n                return false;\n            return currentRoomGroup.value.roomIds.includes(store.player.currentLocation);\n        });\n        // 打开弹窗\n        function openModal(roomGroup) {\n            currentRoomGroup.value = roomGroup;\n            isVisible.value = true;\n        }\n        // 关闭弹窗\n        function closeModal() {\n            isVisible.value = false;\n            setTimeout(() => {\n                currentRoomGroup.value = null;\n            }, 300);\n        }\n        // 检查房间访问权限\n        function checkRoomAccess() {\n            if (!currentRoomGroup.value)\n                return { canAccess: false, message: '' };\n            const roomType = currentRoomGroup.value.类型;\n            // 只有套间需要检查访问权限\n            if (roomType === '套间') {\n                const roomId = currentRoomGroup.value.roomIds[0];\n                const room = store.apartments.房间列表[roomId];\n                // 检查是否有住户\n                if (room && room.住户 && room.住户 !== '未知') {\n                    // 检查房间内是否有人\n                    const hasOccupants = occupants.value.some(p => p.isTenant);\n                    if (hasOccupants) {\n                        return { canAccess: false, message: '似乎有人在……' };\n                    }\n                    else {\n                        return { canAccess: false, message: '好像上锁了……' };\n                    }\n                }\n            }\n            return { canAccess: true, message: '' };\n        }\n        // 移动到房间\n        function moveToRoom() {\n            if (!currentRoomGroup.value || isCurrentLocation.value)\n                return;\n            // 检查访问权限\n            const accessCheck = checkRoomAccess();\n            if (!accessCheck.canAccess) {\n                alert(accessCheck.message);\n                return;\n            }\n            // 使用第一个房间ID作为目标\n            const targetRoomId = currentRoomGroup.value.roomIds[0];\n            store.moveToRoom(targetRoomId);\n            closeModal();\n        }\n        // 获取房间ID显示\n        function getRoomIdDisplay() {\n            if (!currentRoomGroup.value)\n                return '';\n            if (currentRoomGroup.value.isMerged) {\n                return currentRoomGroup.value.roomIds.join('-');\n            }\n            return currentRoomGroup.value.id;\n        }\n        // 获取房间描述\n        function getRoomDescription() {\n            if (!currentRoomGroup.value)\n                return '';\n            // 从第一个房间ID获取描述\n            const firstRoomId = currentRoomGroup.value.roomIds[0];\n            const room = store.apartments.房间列表[firstRoomId];\n            return room?.描述 || '';\n        }\n        // 获取房间样式类\n        function getRoomClass() {\n            if (!currentRoomGroup.value)\n                return '';\n            const type = currentRoomGroup.value.类型;\n            if (type === '套间') {\n                return currentRoomGroup.value.住户 === '未知' ? 'bedroom vacant' : 'bedroom';\n            }\n            else if (type === '您的房间') {\n                return 'your';\n            }\n            else if (type === '公共客厅') {\n                return 'public-lounge';\n            }\n            else if (type === '健身房') {\n                return 'public-gym';\n            }\n            else if (type === '洗衣间') {\n                return 'public-laundry';\n            }\n            return 'custom-functional';\n        }\n        // 打开互动面板\n        function openInteractionPanel(tenantName) {\n            selectedTenant.value = tenantName;\n            showInteractionPanel.value = true;\n        }\n        // 关闭互动面板\n        function closeInteractionPanel() {\n            showInteractionPanel.value = false;\n            selectedTenant.value = '';\n        }\n        // 处理互动\n        function handleInteraction(action) {\n            console.log(`与 ${selectedTenant.value} 进行互动: ${action}`);\n            // TODO: 实现具体的互动逻辑\n            if (action === 'chat') {\n                store.interactWithTenant(selectedTenant.value);\n                closeInteractionPanel();\n                closeModal();\n            }\n            else {\n                // 其他互动选项暂未实现\n                alert(`${action} 功能开发中...`);\n            }\n        }\n        // 暴露方法给父组件\n        __expose({\n            openModal,\n            closeModal,\n        });\n        return (_ctx, _cache) => {\n            return (isVisible.value)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"modal-overlay\",\n                    onClick: _withModifiers(closeModal, [\"self\"])\n                }, [\n                    _createElementVNode(\"div\", {\n                        class: _normalizeClass([\"modal-content\", getRoomClass()])\n                    }, [\n                        _createCommentVNode(\" 弹窗标题 \"),\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"h2\", _hoisted_2, [\n                                _cache[3] || (_cache[3] = _createElementVNode(\"span\", { class: \"room-icon\" }, \"🏠\", -1 /* CACHED */)),\n                                _createTextVNode(\" \" + _toDisplayString(roomInfo.value?.displayName || '房间详情'), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: \"close-btn\",\n                                onClick: closeModal\n                            }, \"✕\")\n                        ]),\n                        _createCommentVNode(\" 弹窗主体 \"),\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            (roomInfo.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                                    _createCommentVNode(\" 基础信息 \"),\n                                    _createElementVNode(\"div\", _hoisted_5, [\n                                        _cache[8] || (_cache[8] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"📋 基础信息\", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_6, [\n                                            _createElementVNode(\"div\", _hoisted_7, [\n                                                _cache[4] || (_cache[4] = _createElementVNode(\"span\", { class: \"info-label\" }, \"房间号：\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", _hoisted_8, _toDisplayString(getRoomIdDisplay()), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_9, [\n                                                _cache[5] || (_cache[5] = _createElementVNode(\"span\", { class: \"info-label\" }, \"类型：\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", _hoisted_10, _toDisplayString(roomInfo.value.类型), 1 /* TEXT */)\n                                            ]),\n                                            (roomInfo.value.住户)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                                    _cache[6] || (_cache[6] = _createElementVNode(\"span\", { class: \"info-label\" }, \"住户：\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_12, _toDisplayString(roomInfo.value.住户), 1 /* TEXT */)\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (roomInfo.value.功能区)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                                                    _cache[7] || (_cache[7] = _createElementVNode(\"span\", { class: \"info-label\" }, \"功能区：\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_14, _toDisplayString(roomInfo.value.功能区), 1 /* TEXT */)\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ])\n                                    ]),\n                                    _createCommentVNode(\" 当前在此房间的人 \"),\n                                    _createElementVNode(\"div\", _hoisted_15, [\n                                        _cache[9] || (_cache[9] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"👥 当前在此\", -1 /* CACHED */)),\n                                        (occupants.value.length > 0)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_16, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(occupants.value, (person) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        key: person.name,\n                                                        class: _normalizeClass(['occupant-card', { clickable: person.isTenant && isCurrentLocation.value }]),\n                                                        onClick: ($event) => (person.isTenant && isCurrentLocation.value ? openInteractionPanel(person.name) : null)\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_18, _toDisplayString(person.icon), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_19, _toDisplayString(person.name), 1 /* TEXT */)\n                                                    ], 10 /* CLASS, PROPS */, _hoisted_17));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ]))\n                                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_20, \"当前房间无人\"))\n                                    ]),\n                                    _createCommentVNode(\" 房间描述（如果有） \"),\n                                    (getRoomDescription())\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, [\n                                            _cache[10] || (_cache[10] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"📝 房间描述\", -1 /* CACHED */)),\n                                            _createElementVNode(\"p\", _hoisted_22, _toDisplayString(getRoomDescription()), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createCommentVNode(\" 弹窗底部操作按钮 \"),\n                        _createElementVNode(\"div\", _hoisted_23, [\n                            _createElementVNode(\"button\", {\n                                class: \"apt-btn apt-btn-secondary\",\n                                onClick: closeModal\n                            }, \"取消\"),\n                            _createElementVNode(\"button\", {\n                                class: \"apt-btn\",\n                                onClick: moveToRoom,\n                                disabled: isCurrentLocation.value || _unref(store).isLoading\n                            }, [\n                                (isCurrentLocation.value)\n                                    ? (_openBlock(), _createElementBlock(\"span\", _hoisted_25, \"✓ 当前位置\"))\n                                    : (_openBlock(), _createElementBlock(\"span\", _hoisted_26, \"🚶 移动到此\"))\n                            ], 8 /* PROPS */, _hoisted_24)\n                        ])\n                    ], 2 /* CLASS */),\n                    _createCommentVNode(\" 租客互动面板 \"),\n                    (showInteractionPanel.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", {\n                            key: 0,\n                            class: \"interaction-overlay\",\n                            onClick: _withModifiers(closeInteractionPanel, [\"self\"])\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_27, [\n                                _createElementVNode(\"div\", _hoisted_28, [\n                                    _createElementVNode(\"h3\", _hoisted_29, [\n                                        _cache[11] || (_cache[11] = _createElementVNode(\"span\", { class: \"interaction-icon\" }, \"💬\", -1 /* CACHED */)),\n                                        _createTextVNode(\" 与 \" + _toDisplayString(selectedTenant.value) + \" 互动 \", 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"button\", {\n                                        class: \"close-btn\",\n                                        onClick: closeInteractionPanel\n                                    }, \"✕\")\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_30, [\n                                    _cache[15] || (_cache[15] = _createElementVNode(\"p\", { class: \"interaction-hint\" }, \"互动选项开发中...\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_31, [\n                                        _createElementVNode(\"button\", {\n                                            class: \"apt-btn\",\n                                            onClick: _cache[0] || (_cache[0] = ($event) => (handleInteraction('chat')))\n                                        }, [...(_cache[12] || (_cache[12] = [\n                                                _createElementVNode(\"span\", null, \"💬\", -1 /* CACHED */),\n                                                _createElementVNode(\"span\", null, \"聊天\", -1 /* CACHED */)\n                                            ]))]),\n                                        _createElementVNode(\"button\", {\n                                            class: \"apt-btn apt-btn-secondary\",\n                                            onClick: _cache[1] || (_cache[1] = ($event) => (handleInteraction('gift')))\n                                        }, [...(_cache[13] || (_cache[13] = [\n                                                _createElementVNode(\"span\", null, \"🎁\", -1 /* CACHED */),\n                                                _createElementVNode(\"span\", null, \"送礼\", -1 /* CACHED */)\n                                            ]))]),\n                                        _createElementVNode(\"button\", {\n                                            class: \"apt-btn apt-btn-secondary\",\n                                            onClick: _cache[2] || (_cache[2] = ($event) => (handleInteraction('invite')))\n                                        }, [...(_cache[14] || (_cache[14] = [\n                                                _createElementVNode(\"span\", null, \"🎮\", -1 /* CACHED */),\n                                                _createElementVNode(\"span\", null, \"邀请活动\", -1 /* CACHED */)\n                                            ]))])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", { class: \"interaction-footer\" }, [\n                                    _createElementVNode(\"button\", {\n                                        class: \"apt-btn apt-btn-secondary\",\n                                        onClick: closeInteractionPanel\n                                    }, \"关闭\")\n                                ])\n                            ])\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RoomDetailModal.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RoomDetailModal.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RoomDetailModal.vue?vue&type=style&index=0&id=a67ded24&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_96d39c74a8c06e57a334244d199e36ff/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-a67ded24\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"map-view apt-card\" };\nconst _hoisted_2 = { class: \"apt-card-body custom-scrollbar\" };\nconst _hoisted_3 = { class: \"floor-title\" };\nconst _hoisted_4 = { class: \"floor-grid\" };\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = { class: \"room-info\" };\nconst _hoisted_7 = { class: \"room-id\" };\nconst _hoisted_8 = { class: \"room-name\" };\nconst _hoisted_9 = { class: \"room-occupants\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"occupants-summary\"\n};\nconst _hoisted_11 = { class: \"summary-text\" };\nconst _hoisted_12 = {\n    key: 1,\n    class: \"occupants-list\"\n};\nconst _hoisted_13 = { class: \"person-icon\" };\nconst _hoisted_14 = { class: \"person-name\" };\nconst _hoisted_15 = {\n    key: 2,\n    class: \"empty-indicator\"\n};\nimport _ from 'lodash';\nimport { computed, ref } from 'vue';\nimport { useGameStore } from '../gameStore';\nimport RoomDetailModal from './RoomDetailModal.vue';\n// 按顺序（从高到低）排序楼层\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MapView',\n    setup(__props) {\n        const store = useGameStore();\n        const roomDetailModal = ref(null);\n        // 房间组接口\n        const sortedFloors = computed(() => {\n            const floors = store.apartments.楼层配置;\n            return _.orderBy(Object.entries(floors).map(([key, value]) => ({ key, ...value })), ['顺序'], ['desc']).reduce((acc, floor) => {\n                acc[floor.key] = floor;\n                return acc;\n            }, {});\n        });\n        // 获取指定楼层的房间组（合并公共区域）\n        function getFloorRoomGroups(floorKey) {\n            const rooms = store.apartments.房间列表;\n            const floorRooms = _.pickBy(rooms, room => room.布局?.楼层 === floorKey);\n            const roomGroups = [];\n            const processedRoomIds = new Set();\n            // 按房间ID排序\n            const sortedRoomIds = Object.keys(floorRooms).sort();\n            for (const roomId of sortedRoomIds) {\n                if (processedRoomIds.has(roomId))\n                    continue;\n                const room = floorRooms[roomId];\n                const roomType = room.类型;\n                // 检查是否需要合并\n                if (roomType === '公共客厅' && floorKey === '一楼') {\n                    // 合并101和102\n                    const relatedRooms = ['101', '102'].filter(id => floorRooms[id]);\n                    relatedRooms.forEach(id => processedRoomIds.add(id));\n                    roomGroups.push({\n                        id: 'lounge-merged',\n                        displayName: '公共客厅',\n                        类型: '公共客厅',\n                        功能区: '会客区、用餐区、休息区、娱乐区',\n                        roomIds: relatedRooms,\n                        isMerged: true,\n                    });\n                }\n                else if (roomType === '健身房' && floorKey === '一楼') {\n                    // 合并103和104\n                    const relatedRooms = ['103', '104'].filter(id => floorRooms[id]);\n                    relatedRooms.forEach(id => processedRoomIds.add(id));\n                    roomGroups.push({\n                        id: 'gym-merged',\n                        displayName: '健身房',\n                        类型: '健身房',\n                        功能区: '健身设备区、瑜伽区、舞蹈区',\n                        roomIds: relatedRooms,\n                        isMerged: true,\n                    });\n                }\n                else {\n                    // 普通房间，不合并\n                    processedRoomIds.add(roomId);\n                    roomGroups.push({\n                        id: roomId,\n                        displayName: roomId,\n                        类型: roomType,\n                        住户: room.住户,\n                        功能区: room.功能区,\n                        roomIds: [roomId],\n                        isMerged: false,\n                    });\n                }\n            }\n            return roomGroups;\n        }\n        // 获取房间组的样式类\n        function getRoomClass(roomGroup) {\n            const type = roomGroup.类型;\n            if (type === '套间') {\n                return roomGroup.住户 === '未知' ? 'bedroom vacant' : 'bedroom';\n            }\n            else if (type === '您的房间') {\n                return 'your';\n            }\n            else if (type === '公共客厅') {\n                return 'public-lounge';\n            }\n            else if (type === '健身房') {\n                return 'public-gym';\n            }\n            else if (type === '洗衣间') {\n                return 'public-laundry';\n            }\n            else if (type === '空房间') {\n                return 'empty';\n            }\n            return 'custom-functional';\n        }\n        // 获取房间组中的所有人（包括玩家和租客）\n        function getRoomGroupOccupants(roomGroup) {\n            const occupants = [];\n            // 遍历房间组包含的所有房间ID\n            for (const roomId of roomGroup.roomIds) {\n                // 检查玩家是否在此房间\n                if (store.player.currentLocation === roomId) {\n                    occupants.push({ name: '你', icon: '👤' });\n                }\n                // 检查租客是否在此房间\n                for (const [tenantName, tenant] of Object.entries(store.tenants)) {\n                    if (tenant.当前位置 === roomId) {\n                        occupants.push({ name: tenantName, icon: '👥' });\n                    }\n                }\n            }\n            // 去重（如果有重复）\n            return _.uniqBy(occupants, 'name');\n        }\n        // 获取房间ID显示\n        function getRoomIdDisplay(roomGroup) {\n            if (roomGroup.isMerged) {\n                return roomGroup.roomIds.join('-');\n            }\n            return roomGroup.roomIds[0];\n        }\n        // 房间点击事件 - 打开详情弹窗\n        function onRoomClick(roomGroup) {\n            console.log('点击房间组:', roomGroup);\n            roomDetailModal.value?.openModal(roomGroup);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"apt-card-title\" }, [\n                    _createElementVNode(\"span\", null, \"🏢\"),\n                    _createElementVNode(\"span\", null, \"公寓地图\"),\n                    _createElementVNode(\"span\", { class: \"subtitle\" }, \"点击房间查看详情\")\n                ], -1 /* CACHED */)),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\" 按楼层倒序显示（三楼在最上面） \"),\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(sortedFloors.value, (floorConfig, floorKey) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: floorKey,\n                            class: \"floor-level\"\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_3, _toDisplayString(floorConfig.显示名称), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createCommentVNode(\" 遍历处理后的房间列表（合并了公共区域） \"),\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(getFloorRoomGroups(floorKey), (roomGroup) => {\n                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                        key: roomGroup.id,\n                                        class: _normalizeClass(['room-card', getRoomClass(roomGroup), { 'double-width': roomGroup.isMerged }]),\n                                        onClick: ($event) => (onRoomClick(roomGroup))\n                                    }, [\n                                        _createCommentVNode(\" 左侧：房间基础信息 \"),\n                                        _createElementVNode(\"div\", _hoisted_6, [\n                                            _createElementVNode(\"div\", _hoisted_7, _toDisplayString(getRoomIdDisplay(roomGroup)), 1 /* TEXT */),\n                                            _createElementVNode(\"div\", _hoisted_8, _toDisplayString(roomGroup.类型), 1 /* TEXT */)\n                                        ]),\n                                        _createCommentVNode(\" 右侧：当前在这里的人 \"),\n                                        _createElementVNode(\"div\", _hoisted_9, [\n                                            (getRoomGroupOccupants(roomGroup).length > 2)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                                                    _cache[0] || (_cache[0] = _createElementVNode(\"span\", { class: \"summary-icon\" }, \"👥\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(getRoomGroupOccupants(roomGroup).length) + \"人\", 1 /* TEXT */)\n                                                ]))\n                                                : (getRoomGroupOccupants(roomGroup).length > 0)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(getRoomGroupOccupants(roomGroup), (person) => {\n                                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                                key: person.name,\n                                                                class: \"person-indicator\"\n                                                            }, [\n                                                                _createElementVNode(\"span\", _hoisted_13, _toDisplayString(person.icon), 1 /* TEXT */),\n                                                                _createElementVNode(\"span\", _hoisted_14, _toDisplayString(person.name), 1 /* TEXT */)\n                                                            ]));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ]))\n                                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, \"空\"))\n                                        ])\n                                    ], 10 /* CLASS, PROPS */, _hoisted_5));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ])\n                        ]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ]),\n                _createCommentVNode(\" 房间详情弹窗 \"),\n                _createVNode(RoomDetailModal, {\n                    ref_key: \"roomDetailModal\",\n                    ref: roomDetailModal\n                }, null, 512 /* NEED_PATCH */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MapView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MapView.vue?vue&type=style&index=0&id=723e6358&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_96d39c74a8c06e57a334244d199e36ff/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-723e6358\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"narrative-window apt-card\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"narrative-list\"\n};\nconst _hoisted_4 = { class: \"entry-time\" };\nconst _hoisted_5 = { class: \"entry-content\" };\nimport { nextTick, ref, watch } from 'vue';\nimport { useGameStore } from '../gameStore';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NarrativeWindow',\n    setup(__props) {\n        const store = useGameStore();\n        // DOM 引用\n        const narrativeBody = ref(null);\n        // 清空叙事内容\n        function clearNarrative() {\n            store.clearNarrativeLog();\n        }\n        // 滚动到底部\n        function scrollToBottom() {\n            if (narrativeBody.value) {\n                narrativeBody.value.scrollTop = narrativeBody.value.scrollHeight;\n            }\n        }\n        // 监听 narrativeLog 变化，自动滚动到底部\n        watch(() => store.narrativeLog.length, () => {\n            nextTick(() => {\n                scrollToBottom();\n            });\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"apt-card-title\" }, [\n                    _createElementVNode(\"span\", null, \"📖\"),\n                    _createElementVNode(\"span\", null, \"叙事窗口\")\n                ], -1 /* CACHED */)),\n                _createElementVNode(\"div\", {\n                    class: \"apt-card-body custom-scrollbar\",\n                    ref_key: \"narrativeBody\",\n                    ref: narrativeBody\n                }, [\n                    (_unref(store).narrativeLog.length === 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                                _createElementVNode(\"div\", { class: \"empty-icon\" }, \"📝\", -1 /* CACHED */),\n                                _createElementVNode(\"div\", { class: \"empty-text\" }, \"暂无叙事内容\", -1 /* CACHED */),\n                                _createElementVNode(\"div\", { class: \"empty-hint\" }, \"与租客互动或推进时间时，叙事内容将显示在这里\", -1 /* CACHED */)\n                            ]))]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(store).narrativeLog, (entry) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: entry.id,\n                                    class: _normalizeClass(['narrative-entry', entry.type])\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_4, _toDisplayString(entry.timestamp), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_5, _toDisplayString(entry.text), 1 /* TEXT */)\n                                ], 2 /* CLASS */));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                ], 512 /* NEED_PATCH */),\n                _createCommentVNode(\" 底部工具栏 \"),\n                _createElementVNode(\"div\", { class: \"narrative-footer\" }, [\n                    _createElementVNode(\"button\", {\n                        class: \"apt-btn apt-btn-small apt-btn-secondary\",\n                        onClick: clearNarrative\n                    }, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"span\", null, \"🗑️ 清空\", -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        class: \"apt-btn apt-btn-small apt-btn-secondary\",\n                        onClick: scrollToBottom\n                    }, [...(_cache[2] || (_cache[2] = [\n                            _createElementVNode(\"span\", null, \"⬇️ 滚到底部\", -1 /* CACHED */)\n                        ]))])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NarrativeWindow.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NarrativeWindow.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NarrativeWindow.vue?vue&type=style&index=0&id=aa9c1544&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_96d39c74a8c06e57a334244d199e36ff/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-aa9c1544\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"profile-page apt-card\" };\nconst _hoisted_2 = { class: \"apt-card-title\" };\nconst _hoisted_3 = { class: \"subtitle\" };\nconst _hoisted_4 = { class: \"apt-card-body custom-scrollbar\" };\nconst _hoisted_5 = { class: \"tenants-grid\" };\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = { class: \"tenant-basic-info\" };\nconst _hoisted_8 = { class: \"tenant-name\" };\nconst _hoisted_9 = { class: \"tenant-meta\" };\nconst _hoisted_10 = { class: \"meta-item\" };\nconst _hoisted_11 = { class: \"meta-item\" };\nconst _hoisted_12 = { class: \"detail-panel\" };\nconst _hoisted_13 = { class: \"detail-header\" };\nconst _hoisted_14 = { class: \"detail-title\" };\nconst _hoisted_15 = { class: \"detail-body custom-scrollbar\" };\nconst _hoisted_16 = {\n    key: 0,\n    class: \"tenant-details\"\n};\nconst _hoisted_17 = { class: \"detail-section\" };\nconst _hoisted_18 = { class: \"info-grid\" };\nconst _hoisted_19 = { class: \"info-item\" };\nconst _hoisted_20 = { class: \"info-value\" };\nconst _hoisted_21 = { class: \"info-item\" };\nconst _hoisted_22 = { class: \"info-value highlight\" };\nconst _hoisted_23 = { class: \"detail-section\" };\nconst _hoisted_24 = {\n    key: 0,\n    class: \"memories-list\"\n};\nconst _hoisted_25 = { class: \"memory-text\" };\nconst _hoisted_26 = {\n    key: 1,\n    class: \"empty-message\"\n};\nconst _hoisted_27 = { class: \"detail-section\" };\nconst _hoisted_28 = {\n    key: 0,\n    class: \"schedule-list\"\n};\nconst _hoisted_29 = { class: \"schedule-time\" };\nconst _hoisted_30 = { class: \"schedule-activity\" };\nconst _hoisted_31 = { class: \"schedule-location\" };\nconst _hoisted_32 = {\n    key: 1,\n    class: \"empty-message\"\n};\nimport { computed, ref } from 'vue';\nimport { useGameStore } from '../gameStore';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ProfilePage',\n    setup(__props) {\n        const store = useGameStore();\n        const selectedTenantName = ref(null);\n        // 选中的租客数据\n        const selectedTenantData = computed(() => {\n            if (!selectedTenantName.value)\n                return null;\n            return store.tenants[selectedTenantName.value];\n        });\n        // 选择租客\n        function selectTenant(tenantName) {\n            selectedTenantName.value = tenantName;\n        }\n        // 关闭详情\n        function closeDetail() {\n            selectedTenantName.value = null;\n        }\n        // 获取房间名称\n        function getRoomName(roomId) {\n            const room = store.apartments.房间列表[roomId];\n            if (!room)\n                return roomId;\n            // 如果有住户，显示\"XX的房间\"\n            if (room.住户 && room.住户 !== '未知') {\n                return `${room.住户}的房间`;\n            }\n            // 否则显示房间类型\n            return room.类型 || roomId;\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"span\", null, \"📋\", -1 /* CACHED */)),\n                    _cache[1] || (_cache[1] = _createElementVNode(\"span\", null, \"租客档案\", -1 /* CACHED */)),\n                    _createElementVNode(\"span\", _hoisted_3, _toDisplayString(Object.keys(_unref(store).tenants).length) + \" 位租客\", 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(store).tenants, (tenant, tenantName) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: tenantName,\n                                class: \"tenant-profile-card\",\n                                onClick: ($event) => (selectTenant(tenantName))\n                            }, [\n                                _createCommentVNode(\" 租客头像 \"),\n                                _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"tenant-avatar\" }, [\n                                    _createElementVNode(\"span\", { class: \"avatar-icon\" }, \"👤\")\n                                ], -1 /* CACHED */)),\n                                _createCommentVNode(\" 租客基础信息 \"),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"h3\", _hoisted_8, _toDisplayString(tenantName), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_9, [\n                                        _createElementVNode(\"span\", _hoisted_10, [\n                                            _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"meta-icon\" }, \"📍\", -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", null, _toDisplayString(getRoomName(tenant.当前位置)), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"span\", _hoisted_11, [\n                                            _cache[3] || (_cache[3] = _createElementVNode(\"span\", { class: \"meta-icon\" }, \"💖\", -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", null, \"好感度 \" + _toDisplayString(tenant.好感度), 1 /* TEXT */)\n                                        ])\n                                    ])\n                                ])\n                            ], 8 /* PROPS */, _hoisted_6));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createCommentVNode(\" 租客详情弹窗 \"),\n                (selectedTenantName.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"detail-overlay\",\n                        onClick: _withModifiers(closeDetail, [\"self\"])\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_12, [\n                            _createElementVNode(\"div\", _hoisted_13, [\n                                _createElementVNode(\"h2\", _hoisted_14, [\n                                    _cache[5] || (_cache[5] = _createElementVNode(\"span\", { class: \"detail-icon\" }, \"👤\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(selectedTenantName.value), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    onClick: closeDetail\n                                }, \"✕\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_15, [\n                                (selectedTenantData.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_16, [\n                                        _createCommentVNode(\" 基础信息 \"),\n                                        _createElementVNode(\"div\", _hoisted_17, [\n                                            _cache[8] || (_cache[8] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"📋 基础信息\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_18, [\n                                                _createElementVNode(\"div\", _hoisted_19, [\n                                                    _cache[6] || (_cache[6] = _createElementVNode(\"span\", { class: \"info-label\" }, \"当前位置：\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_20, _toDisplayString(getRoomName(selectedTenantData.value.当前位置)), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_21, [\n                                                    _cache[7] || (_cache[7] = _createElementVNode(\"span\", { class: \"info-label\" }, \"好感度：\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_22, _toDisplayString(selectedTenantData.value.好感度), 1 /* TEXT */)\n                                                ])\n                                            ])\n                                        ]),\n                                        _createCommentVNode(\" 记忆 \"),\n                                        _createElementVNode(\"div\", _hoisted_23, [\n                                            _cache[10] || (_cache[10] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"💭 记忆\", -1 /* CACHED */)),\n                                            (selectedTenantData.value.记忆 && selectedTenantData.value.记忆.length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_24, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedTenantData.value.记忆, (memory, index) => {\n                                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                                            key: index,\n                                                            class: \"memory-item\"\n                                                        }, [\n                                                            _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"memory-icon\" }, \"📝\", -1 /* CACHED */)),\n                                                            _createElementVNode(\"span\", _hoisted_25, _toDisplayString(memory), 1 /* TEXT */)\n                                                        ]));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_26, \"暂无记忆\"))\n                                        ]),\n                                        _createCommentVNode(\" 日程 \"),\n                                        _createElementVNode(\"div\", _hoisted_27, [\n                                            _cache[11] || (_cache[11] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"📅 日程安排\", -1 /* CACHED */)),\n                                            (selectedTenantData.value.日程)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_28, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedTenantData.value.日程, (schedule, time) => {\n                                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                                            key: time,\n                                                            class: \"schedule-item\"\n                                                        }, [\n                                                            _createElementVNode(\"span\", _hoisted_29, _toDisplayString(time), 1 /* TEXT */),\n                                                            _createElementVNode(\"span\", _hoisted_30, _toDisplayString(schedule.活动), 1 /* TEXT */),\n                                                            _createElementVNode(\"span\", _hoisted_31, \"@ \" + _toDisplayString(getRoomName(schedule.位置)), 1 /* TEXT */)\n                                                        ]));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_32, \"暂无日程\"))\n                                        ])\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _createElementVNode(\"div\", { class: \"detail-footer\" }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"apt-btn apt-btn-secondary\",\n                                    onClick: closeDetail\n                                }, \"关闭\")\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ProfilePage.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ProfilePage.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ProfilePage.vue?vue&type=style&index=0&id=05e19d48&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_96d39c74a8c06e57a334244d199e36ff/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-05e19d48\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, unref as _unref, toDisplayString as _toDisplayString, createVNode as _createVNode, vShow as _vShow, withDirectives as _withDirectives, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { id: \"app-container\" };\nconst _hoisted_2 = { class: \"main-card apt-card\" };\nconst _hoisted_3 = { class: \"header-bar\" };\nconst _hoisted_4 = { class: \"header-info-line\" };\nconst _hoisted_5 = { class: \"info-item\" };\nconst _hoisted_6 = { class: \"info-item\" };\nconst _hoisted_7 = { class: \"info-item\" };\nconst _hoisted_8 = { class: \"tab-content\" };\nconst _hoisted_9 = { class: \"tab-pane\" };\nconst _hoisted_10 = { class: \"tab-pane\" };\nconst _hoisted_11 = { class: \"tab-pane\" };\nconst _hoisted_12 = { class: \"tab-pane\" };\nconst _hoisted_13 = { class: \"tab-pane\" };\nconst _hoisted_14 = { class: \"tab-buttons\" };\nimport { klona } from 'klona/lite'; // 根據 .cursor 規則，使用 klona 去除 proxy\nimport { computed, onMounted, ref, watchEffect } from 'vue';\nimport { useGameStore } from './gameStore';\n// 導入所有組件\nimport ActionPanel from './components/ActionPanel.vue';\nimport InventoryPage from './components/InventoryPage.vue';\nimport MapView from './components/MapView.vue';\nimport NarrativeWindow from './components/NarrativeWindow.vue';\nimport ProfilePage from './components/ProfilePage.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    setup(__props) {\n        const store = useGameStore();\n        const messageId = getCurrentMessageId(); // 獲取當前消息樓層 ID\n        // 当前激活的标签页（默认为地图页）\n        const activeTab = ref('map');\n        // 计算属性：当前房间显示\n        const currentRoomDisplay = computed(() => {\n            const roomId = store.player.currentLocation;\n            const room = store.apartments.房间列表[roomId];\n            if (!room)\n                return roomId;\n            // 如果有住户，显示\"XX的房间\"\n            if (room.住户 && room.住户 !== '未知') {\n                return `${room.住户}的房间`;\n            }\n            // 否则显示房间类型\n            return room.类型 || roomId;\n        });\n        // 计算属性：租客总数\n        const tenantCount = computed(() => {\n            return Object.keys(store.tenants).length;\n        });\n        // 计算属性：附近的租客\n        const nearbyTenants = computed(() => {\n            const currentLocation = store.player.currentLocation;\n            const nearby = [];\n            for (const [tenantName, tenant] of Object.entries(store.tenants)) {\n                if (tenant.当前位置 === currentLocation) {\n                    nearby.push(tenantName);\n                }\n            }\n            return nearby;\n        });\n        // 计算属性：背包道具总数\n        const totalItems = computed(() => {\n            return store.player.inventory?.reduce((sum, item) => sum + (item.quantity || 1), 0) || 0;\n        });\n        onMounted(async () => {\n            console.log('App.vue onMounted: 正在加載遊戲狀態...');\n            try {\n                // 1. 從當前消息樓層加載持久化的狀態\n                const loadedState = await getVariables({\n                    type: 'message',\n                    message_id: messageId,\n                });\n                if (loadedState && Object.keys(loadedState).length > 0) {\n                    // 2. 如果有狀態，則恢復 Pinia store\n                    store.$patch(klona(loadedState)); // 使用 klona 確保傳入的是純 JS 對象\n                    console.log('遊戲狀態已從消息樓層成功恢復:', loadedState);\n                    // 3. 添加加載成功日誌\n                    store.addNarrativeMessage('system', '遊戲狀態已從酒館消息樓層成功加載。');\n                }\n                else {\n                    // 3. 如果是第一次加載（沒有保存狀態），添加歡迎日誌\n                    console.log('未找到保存的狀態，初始化新遊戲。');\n                    store.addNarrativeMessage('system', '歡迎來到網紅小區。你作為房東的模擬經營遊戲現在開始。');\n                }\n            }\n            catch (error) {\n                console.error('加載遊戲狀態時出錯:', error);\n                store.addNarrativeMessage('system', `[錯誤] 加載遊戲狀態失敗: ${error.message}`);\n            }\n        });\n        // 4. 監聽 Pinia 狀態變化，並將其自動保存回消息樓層變量\n        watchEffect(async () => {\n            if (store.isLoading) {\n                // 如果正在等待 LLM 回應 (isLoading)，則暫不保存\n                // 避免在 Mvu.parseMessage 還未完成時就觸發保存，導致狀態不一致\n                return;\n            }\n            try {\n                // 使用 klona() 去除 proxy，這對於 replaceVariables 至關重要\n                const stateToSave = klona(store.$state);\n                // 確保只保存核心狀態，而不是整個 store 實例\n                await replaceVariables(stateToSave, {\n                    type: 'message',\n                    message_id: messageId,\n                });\n                console.log('遊戲狀態已自動保存到消息樓層。');\n            }\n            catch (error) {\n                console.error('自動保存遊戲狀態時出錯:', error);\n                // 可選：在敘事日誌中顯示保存失敗\n                // store.addNarrativeMessage('system', `[錯誤] 自動保存失敗: ${error.message}`);\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" 主卡片容器 \"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\" 头部信息栏 \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[7] || (_cache[7] = _createElementVNode(\"div\", { class: \"header-title\" }, [\n                            _createElementVNode(\"span\", { class: \"title-icon\" }, \"🏢\"),\n                            _createElementVNode(\"span\", { class: \"title-text\" }, \"网红小区\")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(_unref(store).world.地点), 1 /* TEXT */),\n                            _cache[5] || (_cache[5] = _createElementVNode(\"span\", { class: \"info-separator\" }, \"|\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", _hoisted_6, _toDisplayString(_unref(store).world.年份) + \" \" + _toDisplayString(_unref(store).world.日期) + \" \" + _toDisplayString(_unref(store).world.星期), 1 /* TEXT */),\n                            _cache[6] || (_cache[6] = _createElementVNode(\"span\", { class: \"info-separator\" }, \"|\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", _hoisted_7, _toDisplayString(_unref(store).world.时间), 1 /* TEXT */)\n                        ])\n                    ]),\n                    _createCommentVNode(\" 标签页内容区域 \"),\n                    _createElementVNode(\"div\", _hoisted_8, [\n                        _createCommentVNode(\" 地图页 \"),\n                        _withDirectives(_createElementVNode(\"div\", _hoisted_9, [\n                            _createVNode(MapView)\n                        ], 512 /* NEED_PATCH */), [\n                            [_vShow, activeTab.value === 'map']\n                        ]),\n                        _createCommentVNode(\" 行动页 \"),\n                        _withDirectives(_createElementVNode(\"div\", _hoisted_10, [\n                            _createVNode(ActionPanel)\n                        ], 512 /* NEED_PATCH */), [\n                            [_vShow, activeTab.value === 'action']\n                        ]),\n                        _createCommentVNode(\" 叙事页 \"),\n                        _withDirectives(_createElementVNode(\"div\", _hoisted_11, [\n                            _createVNode(NarrativeWindow)\n                        ], 512 /* NEED_PATCH */), [\n                            [_vShow, activeTab.value === 'narrative']\n                        ]),\n                        _createCommentVNode(\" 档案页 \"),\n                        _withDirectives(_createElementVNode(\"div\", _hoisted_12, [\n                            _createVNode(ProfilePage)\n                        ], 512 /* NEED_PATCH */), [\n                            [_vShow, activeTab.value === 'profile']\n                        ]),\n                        _createCommentVNode(\" 背包页 \"),\n                        _withDirectives(_createElementVNode(\"div\", _hoisted_13, [\n                            _createVNode(InventoryPage)\n                        ], 512 /* NEED_PATCH */), [\n                            [_vShow, activeTab.value === 'inventory']\n                        ])\n                    ]),\n                    _createCommentVNode(\" 底部标签页切换按钮 \"),\n                    _createElementVNode(\"div\", _hoisted_14, [\n                        _createElementVNode(\"button\", {\n                            class: _normalizeClass(['tab-btn', { active: activeTab.value === 'map' }]),\n                            onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'map'))\n                        }, [...(_cache[8] || (_cache[8] = [\n                                _createElementVNode(\"span\", { class: \"tab-icon\" }, \"🏢\", -1 /* CACHED */),\n                                _createElementVNode(\"span\", { class: \"tab-label\" }, \"地图\", -1 /* CACHED */)\n                            ]))], 2 /* CLASS */),\n                        _createElementVNode(\"button\", {\n                            class: _normalizeClass(['tab-btn', { active: activeTab.value === 'action' }]),\n                            onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'action'))\n                        }, [...(_cache[9] || (_cache[9] = [\n                                _createElementVNode(\"span\", { class: \"tab-icon\" }, \"🎮\", -1 /* CACHED */),\n                                _createElementVNode(\"span\", { class: \"tab-label\" }, \"行动\", -1 /* CACHED */)\n                            ]))], 2 /* CLASS */),\n                        _createElementVNode(\"button\", {\n                            class: _normalizeClass(['tab-btn', { active: activeTab.value === 'narrative' }]),\n                            onClick: _cache[2] || (_cache[2] = ($event) => (activeTab.value = 'narrative'))\n                        }, [...(_cache[10] || (_cache[10] = [\n                                _createElementVNode(\"span\", { class: \"tab-icon\" }, \"📖\", -1 /* CACHED */),\n                                _createElementVNode(\"span\", { class: \"tab-label\" }, \"叙事\", -1 /* CACHED */)\n                            ]))], 2 /* CLASS */),\n                        _createElementVNode(\"button\", {\n                            class: _normalizeClass(['tab-btn', { active: activeTab.value === 'profile' }]),\n                            onClick: _cache[3] || (_cache[3] = ($event) => (activeTab.value = 'profile'))\n                        }, [...(_cache[11] || (_cache[11] = [\n                                _createElementVNode(\"span\", { class: \"tab-icon\" }, \"📋\", -1 /* CACHED */),\n                                _createElementVNode(\"span\", { class: \"tab-label\" }, \"档案\", -1 /* CACHED */)\n                            ]))], 2 /* CLASS */),\n                        _createElementVNode(\"button\", {\n                            class: _normalizeClass(['tab-btn', { active: activeTab.value === 'inventory' }]),\n                            onClick: _cache[4] || (_cache[4] = ($event) => (activeTab.value = 'inventory'))\n                        }, [...(_cache[12] || (_cache[12] = [\n                                _createElementVNode(\"span\", { class: \"tab-icon\" }, \"🎒\", -1 /* CACHED */),\n                                _createElementVNode(\"span\", { class: \"tab-label\" }, \"背包\", -1 /* CACHED */)\n                            ]))], 2 /* CLASS */)\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=2bea59ce&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { createApp } from 'vue';\nimport { createPinia } from 'pinia';\nimport App from './App.vue';\n\n// 引入 to_do.md 中计划要创建的组件的样式 (如果它们有的话)\n// import './components/style.css';\n\n// 在加载脚本时执行\n$(() => {\n  console.log('“网红小区-单页版”脚本加载...');\n\n  const pinia = createPinia();\n  const app = createApp(App);\n\n  app.use(pinia);\n\n  // 将 Vue 应用挂载到 #app 元素上\n  // 这个 #app 元素是在 index.html 中定义的\n  app.mount('#app');\n\n  console.log('Vue 应用已成功挂载.');\n});\n\n// 在卸载脚本时执行\n$(window).on('pagehide', () => {\n  console.log('“网红小区-单页版”脚本卸载.');\n  // 注意: 实际项目中可能需要在这里处理应用卸载和资源清理\n});\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Vue","initialWorldState","initialApartmentsState","initialTenantsState","schedule","startTime","endTime","location","activity","parseTime","timeStr","hours","minutes","split","map","Number","addHours","totalMinutes","mins","Math","floor","toString","padStart","formatTime","isTimeInRange","currentTime","current","start","end","findLocationByTime","entry","useGameStore","world","ref","apartments","tenants","player","currentLocation","inventory","narrativeLog","isLoading","messageIdCounter","addNarrativeMessage","type","text","value","push","id","timestamp","readonly","advanceTime","console","log","newTime","tenantName","tenant","entries","newLocation","oldLocation","scheduleEntry","find","moveToRoom","roomId","interactWithTenant","async","tenantId","warn","room","waitGlobalInitialized","oldMvuData","stat_data","$state","display_data","delta_data","initialized_lorebooks","prompt","llmResponse","generate","max_tokens","temperature","mvuRegex","narrativeText","replace","trim","newMvuData","Mvu","parseMessage","$patch","keys","length","change","error","message","clearNarrativeLog","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","__name","setup","__props","store","_ctx","_cache","onClick","$event","disabled","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","selectedItem","selectedItemIndex","totalItems","computed","reduce","sum","item","quantity","closeDetail","getItemIcon","canUseItem","usable","useItem","alert","name","splice","index","description","effect","_","_hoisted_31","expose","__expose","isVisible","currentRoomGroup","showInteractionPanel","selectedTenant","roomInfo","occupants","people","roomIds","icon","isTenant","isCurrentLocation","includes","closeModal","setTimeout","accessCheck","canAccess","some","p","checkRoomAccess","targetRoomId","getRoomDescription","firstRoomId","getRoomClass","closeInteractionPanel","handleInteraction","action","openModal","roomGroup","displayName","isMerged","join","person","clickable","roomDetailModal","sortedFloors","floors","acc","getFloorRoomGroups","floorKey","rooms","floorRooms","roomGroups","processedRoomIds","Set","sortedRoomIds","sort","has","roomType","relatedRooms","filter","forEach","add","getRoomGroupOccupants","getRoomIdDisplay","floorConfig","RoomDetailModal","ref_key","narrativeBody","clearNarrative","scrollToBottom","scrollTop","scrollHeight","watch","nextTick","_hoisted_32","selectedTenantName","selectedTenantData","getRoomName","memory","time","messageId","getCurrentMessageId","activeTab","nearby","onMounted","loadedState","getVariables","message_id","watchEffect","stateToSave","replaceVariables","MapView","ActionPanel","NarrativeWindow","ProfilePage","InventoryPage","active","$","pinia","app","createApp","App","use","mount","window","on"],"sourceRoot":""}