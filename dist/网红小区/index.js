var n={d:(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},o:(n,t)=>Object.prototype.hasOwnProperty.call(n,t)},t={};n.d(t,{d:()=>h}),console.log('🏠 加载网红小区公寓管理插件...');let e=null,o=null,a=null;let i=0,r=null,l=!1,s='',d='';function c(n,t,e=''){if(!n)return e;const o=t.split('.');let a=n;for(const n of o){if(null==a)return e;if(Array.isArray(a)&&(a=a[0]),'object'!=typeof a||!Object.prototype.hasOwnProperty.call(a,n))return e;a=a[n]}return Array.isArray(a)?a.length>0?String(a[0]??e):e:null==a?e:String(a)}function g(){let n;console.log('🚀 初始化网红小区插件...');try{n=window.top?window.top.document:document}catch(t){console.warn('⚠️ 无法访问 window.top，使用当前 document'),n=document}n.getElementById('ngq-toggle-btn')&&(console.log('⚠️ 网红小区插件已存在，先移除旧的'),n.getElementById('ngq-toggle-btn')?.remove(),n.getElementById('ngq-main-panel')?.remove(),n.getElementById('ngq-plugin-styles')?.remove(),n.getElementById('ngq-recruitment-modal')?.remove(),n.getElementById('ngq-room-modal')?.remove(),n.getElementById('ngq-renovate-modal')?.remove(),n.getElementById('ngq-functional-input-modal')?.remove(),$(n).off('.ngq-plugin'),l=!1),n.getElementById('ngq-plugin-styles')||(n.head.insertAdjacentHTML('beforeend','\n<style id="ngq-plugin-styles">\n:root {\n  --apt-primary: #ff6b9d;\n  --apt-secondary: #c44569;\n  --apt-bg: #1a1a2e;\n  --apt-card: #16213e;\n  --apt-border: rgba(255, 107, 157, 0.2);\n  --apt-text: #e8eaf6;\n  --apt-dim: #e5e7eb;\n}\n\n/* ==================== 拖动按钮 */\n.ngq-toggle-btn {\n  position: fixed !important;\n  top: 100px;\n  left: 20px;\n  width: 64px;\n  height: 64px;\n  background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: grab;\n  z-index: 10000 !important;\n  box-shadow: 0 6px 20px rgba(255, 107, 157, 0.4);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: none;\n  font-size: 28px;\n  border: 3px solid rgba(255, 255, 255, 0.3);\n  color: #fff;\n  transition: transform 0.2s, box-shadow 0.2s, opacity 0.2s;\n}\n\n.ngq-toggle-btn:hover {\n  transform: scale(1.05);\n}\n\n.ngq-toggle-btn.dragging {\n  cursor: grabbing !important;\n  opacity: 0.9;\n  z-index: 10001 !important;\n  transition: none !important;\n}\n\n/* ==================== 主面板容器 */\n.ngq-main-panel {\n  position: fixed !important;\n  top: 50vh !important;\n  left: 50vw !important;\n  transform: translate(-50%, -50%) !important;\n  width: 90vw !important;\n  max-width: 900px !important;\n  height: 85vh !important;\n  max-height: 650px !important;\n  background: var(--apt-bg);\n  background: linear-gradient(135deg, var(--apt-bg) 0%, #16213e 100%);\n  border: 2px solid var(--apt-primary);\n  border-radius: 16px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  z-index: 9999 !important;\n  display: none;\n  flex-direction: column;\n  overflow: hidden;\n  color: var(--apt-text);\n  font-family: \'Microsoft YaHei\', \'Segoe UI\', sans-serif;\n}\n\n.ngq-main-panel.active {\n  display: flex;\n}\n\n.ngq-main-panel.dragging {\n  transition: none !important;\n}\n\n/* ==================== 头部 */\n.ngq-header {\n  flex-shrink: 0;\n  padding: 16px 20px;\n  background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%);\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-weight: 600;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n  cursor: move;\n  user-select: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  transition: opacity 0.2s;\n  touch-action: none !important;\n}\n\n.ngq-header.dragging {\n  opacity: 0.8;\n  cursor: grabbing !important;\n  transition: none !important;\n}\n\n.ngq-header-left {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.ngq-header-title {\n  font-size: 18px;\n  font-weight: 700;\n}\n\n.ngq-header-subtitle {\n  font-size: 12px;\n  opacity: 0.9;\n}\n\n.ngq-close-btn {\n  background: transparent;\n  border: none;\n  color: white;\n  font-size: 32px;\n  cursor: pointer;\n  line-height: 1;\n  padding: 0;\n  width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: transform 0.2s;\n}\n\n.ngq-close-btn:hover {\n  transform: scale(1.1);\n}\n\n/* ==================== 标签页导航 */\n.ngq-tabs {\n  display: flex;\n  flex-shrink: 0;\n  border-bottom: 2px solid rgba(255, 255, 255, 0.1);\n}\n\n.ngq-tab {\n  flex: 1;\n  padding: 12px 16px;\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 14px;\n  cursor: pointer;\n  transition: all 0.3s;\n  border-bottom: 2px solid transparent;\n  text-align: center;\n}\n\n.ngq-tab:hover {\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.ngq-tab.active {\n  color: var(--apt-primary);\n  border-bottom-color: var(--apt-primary);\n}\n\n.ngq-tab-badge {\n  display: inline-block;\n  margin-left: 6px;\n  padding: 2px 6px;\n  background: var(--apt-primary);\n  border-radius: 10px;\n  font-size: 11px;\n  font-weight: 700;\n  color: #fff;\n}\n\n/* ==================== 内容区域 */\n.ngq-content {\n  flex: 1;\n  padding: 20px;\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n}\n\n.ngq-content::-webkit-scrollbar {\n  width: 8px;\n}\n\n.ngq-content::-webkit-scrollbar-track {\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.ngq-content::-webkit-scrollbar-thumb {\n  background: var(--apt-primary);\n  border-radius: 4px;\n}\n\n/* ==================== 卡片样式 */\n.ngq-card {\n  background: var(--apt-card);\n  border: 1px solid var(--apt-border);\n  border-radius: 10px;\n  margin-bottom: 16px;\n  overflow: hidden;\n}\n\n.ngq-card-title {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(255, 107, 157, 0.15);\n  font-weight: 600;\n  font-size: 16px;\n}\n\n.ngq-card-body {\n  padding: 16px;\n}\n\n.ngq-info-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 0;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.ngq-info-row:last-child {\n  border-bottom: none;\n}\n\n.ngq-info-label {\n  color: var(--apt-dim);\n  font-size: 14px;\n}\n\n.ngq-info-value {\n  color: var(--apt-text);\n  font-weight: 500;\n  text-align: right;\n}\n\n/* ==================== 楼层样式 */\n.ngq-floor-level {\n  background: var(--apt-card);\n  border: 1px solid var(--apt-border);\n  border-radius: 12px;\n  padding: 16px;\n  margin-bottom: 16px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);\n}\n\n.ngq-floor-level-title {\n  font-size: 1.1em;\n  font-weight: 600;\n  margin-bottom: 12px;\n  color: var(--apt-text);\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.ngq-floor-grid {\n  display: grid;\n  grid-template-columns: repeat(4, 1fr);\n  gap: 12px;\n  width: 100%;\n}\n\n.ngq-room-card {\n  border-radius: 10px;\n  padding: 18px 12px;\n  min-height: 90px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  font-weight: 600;\n  font-size: 0.9em;\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.ngq-room-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 16px rgba(255, 107, 157, 0.3);\n  border-color: var(--apt-primary);\n}\n\n.ngq-room-card.bedroom {\n  background: linear-gradient(135deg, #592e39 0%, #7a4053 100%);\n}\n\n.ngq-room-card.bedroom.vacant {\n  background: linear-gradient(135deg, rgba(255, 182, 193, 0.6) 0%, rgba(255, 192, 203, 0.7) 100%);\n  border-color: rgba(255, 182, 193, 0.8);\n  backdrop-filter: blur(2px);\n}\n\n.ngq-room-card.empty {\n  background: linear-gradient(135deg, #3d3f47 0%, #4a4f5a 100%);\n  border-color: #5a5f6b;\n  opacity: 0.7;\n}\n\n.ngq-room-card.your {\n  background: linear-gradient(135deg, #2e5266 0%, #3a6d8c 100%);\n  border-color: #5dade2;\n}\n\n/* 公共客厅 - 温馨橙色 */\n.ngq-room-card.public-lounge {\n  background: linear-gradient(135deg, #d97706 0%, #f59e0b 100%);\n  border-color: #fbbf24;\n}\n\n/* 健身房 - 活力绿色 */\n.ngq-room-card.public-gym {\n  background: linear-gradient(135deg, #059669 0%, #10b981 100%);\n  border-color: #34d399;\n}\n\n/* 洗衣间 - 清新蓝色 */\n.ngq-room-card.public-laundry {\n  background: linear-gradient(135deg, #0284c7 0%, #0ea5e9 100%);\n  border-color: #38bdf8;\n}\n\n/* 用户自定义功能性房间 - 半透明绿色 */\n.ngq-room-card.custom-functional {\n  background: linear-gradient(135deg, rgba(16, 185, 129, 0.6) 0%, rgba(52, 211, 153, 0.7) 100%);\n  border-color: rgba(52, 211, 153, 0.8);\n  opacity: 0.95;\n}\n\n/* 合并房间 - 占据双倍宽度 */\n.ngq-room-card.merged {\n  grid-column: span 2;\n}\n\n.ngq-room-name {\n  font-weight: bold;\n  font-size: 0.95em;\n}\n\n.ngq-room-occupant {\n  font-size: 0.75em;\n  color: var(--apt-dim);\n  margin-top: 4px;\n}\n\n/* ==================== 租客卡片 */\n.ngq-tenant-card {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid var(--apt-border);\n  border-radius: 8px;\n  padding: 12px;\n  margin-bottom: 12px;\n  transition: all 0.3s;\n  cursor: pointer;\n}\n\n.ngq-tenant-card:hover {\n  border-color: var(--apt-primary);\n  background: rgba(255, 107, 157, 0.1);\n  transform: translateX(4px);\n}\n\n.ngq-tenant-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.ngq-tenant-name {\n  font-weight: 600;\n  font-size: 15px;\n  color: var(--apt-primary);\n}\n\n.ngq-tenant-badge {\n  font-size: 12px;\n  padding: 2px 8px;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n}\n\n/* ==================== 按钮 */\n.ngq-btn {\n  padding: 10px 16px;\n  background: var(--apt-primary);\n  color: #fff;\n  border: none;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 600;\n  transition: all 0.3s;\n}\n\n.ngq-btn:hover:not(:disabled) {\n  background: var(--apt-secondary);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(255, 107, 157, 0.3);\n}\n\n.ngq-btn:disabled {\n  background: #555;\n  cursor: not-allowed;\n  opacity: 0.4;\n}\n\n.ngq-actions {\n  display: flex;\n  gap: 10px;\n  margin-top: 12px;\n}\n\n.ngq-management-actions {\n  display: flex;\n  flex-direction: row;\n  gap: 12px;\n  margin-top: 12px;\n}\n\n.ngq-management-actions .ngq-btn {\n  flex: 1;\n  padding: 14px 20px;\n  min-width: 0;\n}\n\n@media (max-width: 768px) and (orientation: portrait) {\n  .ngq-management-actions {\n    flex-direction: column;\n  }\n  \n  .ngq-management-actions .ngq-btn {\n    width: 100%;\n  }\n}\n\n.ngq-tenant-actions {\n  margin-bottom: 16px;\n  text-align: center;\n}\n\n/* ==================== 空状态 */\n.ngq-empty {\n  text-align: center;\n  padding: 40px 20px;\n  color: var(--apt-dim);\n}\n\n.ngq-empty-icon {\n  font-size: 48px;\n  margin-bottom: 12px;\n  opacity: 0.5;\n}\n\n.ngq-empty-text {\n  font-size: 14px;\n}\n\n/* ==================== 模态框 */\n.ngq-modal-overlay {\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  width: 100vw !important;\n  height: 100vh !important;\n  background: rgba(0, 0, 0, 0.5);\n  backdrop-filter: blur(4px);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 10500 !important;\n  opacity: 1;\n  transition: opacity 0.3s;\n}\n\n.ngq-modal-overlay.hidden {\n  display: none;\n  opacity: 0;\n}\n\n.ngq-modal-content {\n  background: var(--apt-card);\n  color: var(--apt-text);\n  padding: 28px;\n  border-radius: 20px;\n  width: 90%;\n  max-width: 420px;\n  max-height: 80vh;\n  overflow-y: auto;\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n  border: 2px solid var(--apt-border);\n}\n\n.ngq-modal-title {\n  margin: 0;\n  font-size: 1.4em;\n  font-weight: 700;\n  color: var(--apt-primary);\n}\n\n.ngq-modal-subtitle {\n  color: var(--apt-dim);\n  margin: 0;\n  font-size: 0.95em;\n  line-height: 1.5;\n}\n\n.ngq-modal-input {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid var(--apt-border);\n  border-radius: 8px;\n  color: var(--apt-text);\n  font-size: 14px;\n  outline: none;\n  transition: border-color 0.3s;\n}\n\n.ngq-modal-input:focus {\n  border-color: var(--apt-primary);\n}\n\n.ngq-modal-input::placeholder {\n  color: var(--apt-dim);\n}\n\n.ngq-modal-actions {\n  display: flex;\n  gap: 12px;\n}\n\n.ngq-modal-btn {\n  flex: 1;\n  padding: 12px 16px;\n  border: none;\n  border-radius: 8px;\n  font-size: 14px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s;\n}\n\n.ngq-modal-btn-confirm {\n  background: var(--apt-primary);\n  color: #fff;\n}\n\n.ngq-modal-btn-confirm:hover {\n  background: var(--apt-secondary);\n  transform: translateY(-1px);\n}\n\n.ngq-modal-btn-cancel {\n  background: rgba(255, 255, 255, 0.1);\n  color: var(--apt-text);\n}\n\n.ngq-modal-btn-cancel:hover {\n  background: rgba(255, 255, 255, 0.15);\n}\n\n/* ==================== 加载状态 */\n.ngq-loading {\n  text-align: center;\n  padding: 40px;\n  color: var(--apt-dim);\n}\n\n.ngq-loading-icon {\n  font-size: 32px;\n  margin-bottom: 12px;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* ==================== 进度条 */\n.ngq-progress-bar {\n  width: 100%;\n  height: 20px;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 10px;\n  overflow: hidden;\n  position: relative;\n  margin-top: 6px;\n}\n\n.ngq-progress-fill {\n  height: 100%;\n  border-radius: 10px;\n  transition: width 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 12px;\n  font-weight: 600;\n  color: white;\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\n}\n\n.ngq-progress-fill.favor {\n  background: linear-gradient(90deg, #ff6b9d 0%, #ff8fab 100%);\n}\n\n.ngq-progress-fill.lust {\n  background: linear-gradient(90deg, #ff4757 0%, #ff6348 100%);\n}\n\n.ngq-info-block {\n  display: block;\n  padding: 8px 0;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.ngq-info-block:last-child {\n  border-bottom: none;\n}\n\n.ngq-info-block .ngq-info-label {\n  display: block;\n  margin-bottom: 6px;\n}\n\n.ngq-info-block .ngq-info-value {\n  display: block;\n  text-align: left;\n  line-height: 1.5;\n}\n\n/* ==================== 移动端适配 */\n@media (max-width: 768px) {\n  .ngq-main-panel {\n    width: 95vw;\n    height: 90vh;\n  }\n\n  .ngq-toggle-btn {\n    width: 56px;\n    height: 56px;\n    font-size: 24px;\n  }\n\n  .ngq-tab {\n    font-size: 12px;\n    padding: 10px 8px;\n  }\n\n  .ngq-toggle-btn {\n    pointer-events: auto;\n    z-index: 10002;\n  }\n}\n\n@media (max-width: 480px) and (orientation: portrait) {\n  .ngq-main-panel {\n    width: 100vw;\n    height: 100vh;\n    max-width: none;\n    max-height: none;\n    border-radius: 0;\n    border: none;\n  }\n\n  .ngq-toggle-btn {\n    width: 50px;\n    height: 50px;\n    font-size: 22px;\n  }\n\n  .ngq-tab {\n    font-size: 11px;\n    padding: 8px 4px;\n  }\n\n  .ngq-toggle-btn {\n    z-index: 10002;\n  }\n}\n\n@media (max-height: 600px) and (orientation: landscape) {\n  .ngq-main-panel {\n    height: 95vh;\n    max-height: none;\n  }\n\n  .ngq-content {\n    padding: 10px;\n  }\n}\n\n/* ==================== 全局移动端优化 */\n* {\n  touch-action: manipulation;\n}\n\n.ngq-toggle-btn {\n  touch-action: none !important;\n}\n\n* {\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n}\n\n.ngq-content {\n  -webkit-overflow-scrolling: touch;\n}\n\nbody {\n  -webkit-text-size-adjust: 100%;\n  -ms-text-size-adjust: 100%;\n  text-size-adjust: 100%;\n}\n\n@supports (padding: max(0px)) {\n  @media (max-width: 480px) {\n    .ngq-main-panel {\n      padding-top: max(0px, env(safe-area-inset-top));\n      padding-bottom: max(0px, env(safe-area-inset-bottom));\n      padding-left: max(0px, env(safe-area-inset-left));\n      padding-right: max(0px, env(safe-area-inset-right));\n    }\n  }\n}\n\nbutton:focus,\nbutton:active,\n.ngq-toggle-btn:focus,\n.ngq-toggle-btn:active,\n.ngq-close-btn:focus,\n.ngq-close-btn:active,\n.ngq-tenant-card:focus,\n.ngq-tenant-card:active {\n  outline: none;\n  outline-color: transparent;\n}\n</style>\n'),console.log('✅ 样式已注入')),n.body.insertAdjacentHTML('beforeend','\n\x3c!-- 拖动按钮 --\x3e\n<div id="ngq-toggle-btn" class="ngq-toggle-btn">\n  <span>🏠</span>\n</div>\n\n\x3c!-- 主面板 --\x3e\n<div id="ngq-main-panel" class="ngq-main-panel">\n  <div class="ngq-header">\n    <div class="ngq-header-left">\n      <div class="ngq-header-title">🏠 网红小区</div>\n      <div class="ngq-header-subtitle" id="ngq-time-display">东海市·荟萃城</div>\n    </div>\n    <button class="ngq-close-btn" id="ngq-close-btn">×</button>\n  </div>\n  \n  <div class="ngq-content" id="ngq-content">\n    <div class="ngq-loading">\n      <div class="ngq-loading-icon">⏳</div>\n      <div>正在加载数据...</div>\n    </div>\n  </div>\n</div>\n\n\x3c!-- 招募租客模态框 --\x3e\n<div id="ngq-recruitment-modal" class="ngq-modal-overlay hidden">\n  <div class="ngq-modal-content">\n    <h2 class="ngq-modal-title">👤 招募新租客</h2>\n    <p class="ngq-modal-subtitle">网红小区专注于内容创作者，请输入您期望的租客特征</p>\n    <input type="text" id="ngq-recruitment-keywords" class="ngq-modal-input" placeholder="例如：美妆博主、游戏主播、舞蹈UP主">\n    <div class="ngq-modal-actions">\n      <button class="ngq-modal-btn ngq-modal-btn-cancel" id="ngq-modal-cancel">取消</button>\n      <button class="ngq-modal-btn ngq-modal-btn-confirm" id="ngq-modal-confirm">确认招募</button>\n    </div>\n  </div>\n</div>\n\n\x3c!-- 房间详情模态框 --\x3e\n<div id="ngq-room-modal" class="ngq-modal-overlay hidden">\n  <div class="ngq-modal-content" style="max-width: 500px">\n    <h2 class="ngq-modal-title" id="ngq-room-modal-title">🏠 房间详情</h2>\n    <div id="ngq-room-modal-body"></div>\n    <div class="ngq-modal-actions" id="ngq-room-modal-actions">\n      <button class="ngq-modal-btn ngq-modal-btn-confirm" id="ngq-room-modal-close" style="width:100%">关闭</button>\n    </div>\n    <div class="ngq-modal-actions" id="ngq-room-demolish-actions" style="display:none; margin-top: 8px;">\n      <button class="ngq-modal-btn" id="ngq-room-demolish" style="width:100%; background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);">\n        🗑️ 拆除房间\n      </button>\n    </div>\n  </div>\n</div>\n\n\x3c!-- 装修选择模态框 --\x3e\n<div id="ngq-renovate-modal" class="ngq-modal-overlay hidden">\n  <div class="ngq-modal-content" style="max-width: 450px">\n    <h2 class="ngq-modal-title">🔨 装修选择</h2>\n    <p class="ngq-modal-subtitle" id="ngq-renovate-room-info">选择要将此空房间装修为何种类型：</p>\n    <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 16px;">\n      <button class="ngq-modal-btn ngq-modal-btn-confirm" id="ngq-renovate-suite" style="padding: 16px; font-size: 15px;">\n        🏠 标准套间\n        <div style="font-size: 12px; opacity: 0.8; margin-top: 4px;">一室一厅一卫一厨，可出租给租客</div>\n      </button>\n      <button class="ngq-modal-btn ngq-modal-btn-confirm" id="ngq-renovate-functional" style="padding: 16px; font-size: 15px; background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%);">\n        🔧 功能性房间\n        <div style="font-size: 12px; opacity: 0.8; margin-top: 4px;">公共设施（客厅/健身房/洗衣间等）</div>\n      </button>\n    </div>\n    <div class="ngq-modal-actions" style="margin-top: 16px;">\n      <button class="ngq-modal-btn ngq-modal-btn-cancel" id="ngq-renovate-cancel" style="width:100%">取消</button>\n    </div>\n  </div>\n</div>\n\n\x3c!-- 功能性房间详情输入模态框 --\x3e\n<div id="ngq-functional-input-modal" class="ngq-modal-overlay hidden">\n  <div class="ngq-modal-content" style="max-width: 450px">\n    <h2 class="ngq-modal-title">🔧 功能性房间详情</h2>\n    <p class="ngq-modal-subtitle" id="ngq-functional-room-info">请输入功能性房间的详细信息：</p>\n    <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 16px;">\n      <div>\n        <label style="display: block; margin-bottom: 6px; color: var(--apt-dim); font-size: 14px;">房间名称</label>\n        <input type="text" id="ngq-functional-name" class="ngq-modal-input" placeholder="例如：健身房、影音室、茶室">\n      </div>\n      <div>\n        <label style="display: block; margin-bottom: 6px; color: var(--apt-dim); font-size: 14px;">房间作用</label>\n        <input type="text" id="ngq-functional-purpose" class="ngq-modal-input" placeholder="例如：配备跑步机和瑜伽垫，供租客免费使用">\n      </div>\n    </div>\n    <div class="ngq-modal-actions" style="margin-top: 16px;">\n      <button class="ngq-modal-btn ngq-modal-btn-cancel" id="ngq-functional-cancel">取消</button>\n      <button class="ngq-modal-btn ngq-modal-btn-confirm" id="ngq-functional-confirm">确认装修</button>\n    </div>\n  </div>\n</div>\n'),console.log('✅ HTML 已注入');const t=n.getElementById('ngq-toggle-btn');if(t)try{const n=localStorage.getItem('ngq-btn-position');if(n){const e=JSON.parse(n),o=window.top||window,a=$(o).width()-80,i=$(o).height()-80;e.left>=0&&e.left<=a&&e.top>=0&&e.top<=i?(t.style.left=e.left+'px',t.style.top=e.top+'px',console.log('📍 恢复按钮位置:',e)):console.log('⚠️ 保存的位置无效，使用默认位置')}}catch(n){console.warn('⚠️ 恢复按钮位置失败')}!function(n){const t=n.getElementById('ngq-toggle-btn'),o=n.getElementById('ngq-main-panel'),a=$(n);function r(n,o){if(e)return!1;const a=window.getComputedStyle(t),i=parseInt(a.left)||0,r=parseInt(a.top)||0;return e={startX:n,startY:o,initialLeft:i,initialTop:r},t.classList.add('dragging'),console.log('🖱️ 开始拖动按钮'),!0}function l(n,o){if(!e)return;const a=n-e.startX,i=o-e.startY;let r=e.initialLeft+a,l=e.initialTop+i;const s=window.top||window,d=$(s).width()-80,c=$(s).height()-80;r=Math.max(0,Math.min(r,d)),l=Math.max(0,Math.min(l,c)),t.style.left=r+'px',t.style.top=l+'px'}function s(a,r){if(!e)return;t.classList.remove('dragging');const l=a-e.startX,s=r-e.startY,d=Math.sqrt(l*l+s*s),c=window.getComputedStyle(t),g={left:parseInt(c.left)||0,top:parseInt(c.top)||0};localStorage.setItem('ngq-btn-position',JSON.stringify(g)),console.log('✅ 按钮拖动结束，保存位置:',g),e=null,d<5&&(console.log('🎨 检测到点击，切换面板'),o.classList.toggle('active'),o.classList.contains('active')&&(i=0,p(n)))}$(t).on('mousedown.ngq-plugin',function(n){r(n.clientX,n.clientY)&&(n.preventDefault(),n.stopPropagation())}),$(t).on('touchstart.ngq-plugin',function(n){const t=n.originalEvent.touches[0];r(t.clientX,t.clientY)&&(n.preventDefault(),n.stopPropagation())}),a.on('mousemove.ngq-plugin',function(n){l(n.clientX,n.clientY),e&&n.preventDefault()}),a.on('touchmove.ngq-plugin',function(n){const t=n.originalEvent.touches[0];l(t.clientX,t.clientY),e&&n.preventDefault()}),a.on('mouseup.ngq-plugin',function(n){s(n.clientX,n.clientY)}),a.on('touchend.ngq-plugin touchcancel.ngq-plugin',function(n){const t=n.originalEvent.changedTouches[0];t?s(t.clientX,t.clientY):s(0,0)}),console.log('✅ 按钮拖动功能已初始化')}(n),function(n){const t=n.getElementById('ngq-close-btn');t&&t.addEventListener('click',t=>{t.stopPropagation();const e=n.getElementById('ngq-main-panel');e&&e.classList.remove('active')});(function(n){const t=$('#ngq-main-panel',n)[0],e=$('.ngq-header',n)[0],a=$(n);if(!t||!e)return void console.error('❌ 面板或头部元素未找到');function i(n,a){console.log('🖱️ 开始拖动面板');const i=t.getBoundingClientRect();t.style.setProperty('transform','none','important'),t.style.setProperty('left',`${i.left}px`,'important'),t.style.setProperty('top',`${i.top}px`,'important'),o={startX:n,startY:a,initialLeft:i.left,initialTop:i.top},$(t).addClass('dragging'),$(e).addClass('dragging'),console.log('✅ 面板拖动数据已设置:',o)}function r(n,e){if(!o)return;const a=n-o.startX,i=e-o.startY,r=o.initialLeft+a,l=o.initialTop+i;t.style.setProperty('left',`${r}px`,'important'),t.style.setProperty('top',`${l}px`,'important')}function l(){if(console.log('🖱️ 面板拖动结束'),o){const n=t.getBoundingClientRect(),e={left:n.left,top:n.top};localStorage.setItem('ngq-panel-position',JSON.stringify(e)),console.log('✅ 面板拖动结束，保存位置:',e)}o=null,$(t).removeClass('dragging'),$(e).removeClass('dragging')}$(e).on('mousedown.ngq-panel-drag',function(n){$(n.target).closest('#ngq-close-btn').length>0?console.log('⚠️ 点击了关闭按钮，跳过拖动'):(n.preventDefault(),i(n.clientX,n.clientY))}),a.on('mousemove.ngq-panel-drag',function(n){r(n.clientX,n.clientY)}),a.on('mouseup.ngq-panel-drag',function(){l()}),$(e).on('touchstart.ngq-panel-drag',function(n){if($(n.target).closest('#ngq-close-btn').length>0)return void console.log('⚠️ 触摸了关闭按钮，跳过拖动');const t=n.originalEvent.touches[0];t&&(n.preventDefault(),i(t.clientX,t.clientY))}),a.on('touchmove.ngq-panel-drag',function(n){const t=n.originalEvent.touches[0];t&&r(t.clientX,t.clientY)}),a.on('touchend.ngq-panel-drag touchcancel.ngq-panel-drag',function(){l()});const s=localStorage.getItem('ngq-panel-position');if(s)try{const n=JSON.parse(s);t.style.setProperty('transform','none','important'),t.style.setProperty('left',`${n.left}px`,'important'),t.style.setProperty('top',`${n.top}px`,'important'),console.log('✅ 已恢复面板位置:',n)}catch(n){console.error('❌ 恢复面板位置失败:',n)}console.log('✅ 面板拖动功能已初始化')})(n),console.log('✅ 面板系统已初始化')}(n),function(n){const t=n.getElementById('ngq-modal-confirm');t&&t.addEventListener('click',()=>{f(n)});const e=n.getElementById('ngq-modal-cancel');e&&e.addEventListener('click',()=>{u(n)});const o=n.getElementById('ngq-recruitment-modal');o&&o.addEventListener('click',t=>{t.target===o&&u(n)});const a=n.getElementById('ngq-recruitment-keywords');a&&a.addEventListener('keypress',t=>{'Enter'===t.key&&f(n)});const i=n.getElementById('ngq-room-modal-close');i&&i.addEventListener('click',()=>{v(n)});const r=n.getElementById('ngq-room-demolish');r&&r.addEventListener('click',()=>{!function(n){if(!d)return;if(confirm(`确定要拆除 ${d} 吗？\n拆除后将变为空房间，需要重新装修才能使用。`)){y(`拆除 ${d}，将其还原为空房间状态`),v(n)}}(n)});const l=n.getElementById('ngq-room-modal');l&&l.addEventListener('click',t=>{t.target===l&&v(n)});const c=n.getElementById('ngq-renovate-suite');c&&c.addEventListener('click',()=>{!function(n){if(!s)return;y(`将 ${s} 装修为标准套间（一室一厅一卫一厨，35-50㎡）`),b(n)}(n)});const g=n.getElementById('ngq-renovate-functional');g&&g.addEventListener('click',()=>{!function(n){if(!s)return;(function(n){console.log('🔍 openFunctionalInputModal 被调用，房间号:',s);const t=n.getElementById('ngq-functional-input-modal'),e=n.getElementById('ngq-functional-room-info'),o=n.getElementById('ngq-functional-name'),a=n.getElementById('ngq-functional-purpose');if(console.log('🔍 找到的元素:',{modal:t,info:e,nameInput:o,purposeInput:a}),!(t&&e&&o&&a))return void console.error('❌ 缺少必要元素，无法打开模态框');e.textContent=`请输入 ${s} 的详细信息：`,o.value='',a.value='',t.classList.remove('hidden'),setTimeout(()=>o.focus(),100),console.log('✅ 功能性房间输入模态框已打开')})(n),b(n,!1)}(n)});const p=n.getElementById('ngq-renovate-cancel');p&&p.addEventListener('click',()=>{b(n)});const m=n.getElementById('ngq-renovate-modal');m&&m.addEventListener('click',t=>{t.target===m&&b(n)});const h=n.getElementById('ngq-functional-confirm');console.log('🔍 功能性房间确认按钮:',h),h?h.addEventListener('click',()=>{console.log('🖱️ 功能性房间确认按钮被点击'),x(n)}):console.error('❌ 未找到功能性房间确认按钮 (ngq-functional-confirm)');const w=n.getElementById('ngq-functional-cancel');w&&w.addEventListener('click',()=>{q(n),s=''});const k=n.getElementById('ngq-functional-input-modal');k&&k.addEventListener('click',t=>{t.target===k&&(q(n),s='')});const E=n.getElementById('ngq-functional-name'),I=n.getElementById('ngq-functional-purpose');E&&I&&[E,I].forEach(t=>{t.addEventListener('keypress',t=>{'Enter'===t.key&&x(n)})});console.log('✅ 模态框事件已初始化')}(n),console.log('✅ 网红小区插件初始化完成！')}async function p(n){try{if('undefined'==typeof Mvu)try{if(!window.parent||void 0===window.parent.Mvu)throw new Error('父窗口中也没有 MVU');window.Mvu=window.parent.Mvu,console.log('✅ 已从父窗口引用 MVU')}catch(t){return console.warn('⚠️ MVU 框架未加载或无法访问父窗口'),void(i<5?(i++,console.log(`🔄 第 ${i}/5 次重试加载 MVU...`),setTimeout(()=>p(n),400)):m(n,'MVU 框架未加载，请确保已安装酒馆助手并启用 MVU 框架'))}const t=Mvu.getMvuData({type:'message',message_id:'latest'}),e=t?.stat_data;if(!e)return console.warn('⚠️ MVU 数据为空'),void(i<5?(i++,setTimeout(()=>p(n),400)):m(n,'未能加载数据'));a=e,console.log('✅ 数据加载成功',e),function(n,t){const e=n.getElementById('ngq-content'),o=n.getElementById('ngq-time-display');if(!e)return;if(o){const n=`${c(t,'世界.年份','')} ${c(t,'世界.日期','')} ${c(t,'世界.星期','')}`.trim(),e=c(t,'世界.时间',''),a=c(t,'世界.地点','东海市·荟萃城');o.textContent=`${a} | ${n} ${e}`}const i=function(n){if(!n)return'<div class="ngq-empty"><div class="ngq-empty-icon">📭</div><div>暂无数据</div></div>';const t=n?.公寓?.楼层配置||{},e=n?.公寓?.房间列表&&n.公寓.房间列表[0]||{},o=Object.keys(t).filter(n=>'$meta'!==n).map(n=>({key:n,order:parseFloat(c(t[n],'顺序','0'))||0,name:c(t[n],'显示名称',n),capacity:c(t[n],'总容量','10')})).sort((n,t)=>t.order-n.order);if(0===o.length)return'<div class="ngq-empty"><div class="ngq-empty-icon">🏗️</div><div>未找到楼层数据</div></div>';let a='<div style="display:flex;flex-direction:column;gap:12px">';return o.forEach(n=>{a+=function(n,t){let e='<div class="ngq-floor-level">';e+=`<div class="ngq-floor-level-title">🏢 ${n.name}</div>`,e+='<div class="ngq-floor-grid">';const o=[],a=Object.keys(t).filter(n=>'$meta'!==n);if(a.forEach(e=>{const a=t[e],i=a?.布局;if(!i||'object'!=typeof i)return;if(('string'==typeof i.楼层?i.楼层:String(i.楼层||''))!==n.name)return;const r=c(a,'类型','套间'),l=c(a,'住户','未知'),s='string'==typeof i.位置?i.位置:String(i.位置||'');o.push({name:e,type:r,tenant:l,position:s})}),o.sort((n,t)=>{const e=n=>n.includes('A区')||n.includes('01')?1:n.includes('B区')||n.includes('02')?2:n.includes('C区')||n.includes('03')?3:n.includes('D区')||n.includes('04')?4:0,o=e(n.position)-e(t.position);return 0!==o?o:n.name.localeCompare(t.name)}),0===o.length)return e+='<div style="padding:20px;text-align:center;color:var(--apt-dim)">该楼层暂无房间</div>',e+='</div></div>',e;const i=[],r=new Set;for(let n=0;n<o.length;n++){if(r.has(n))continue;const t=o[n];if(['公共客厅','健身房'].includes(t.type)&&n+1<o.length){const e=o[n+1];if(e.type===t.type){i.push({rooms:[t.name,e.name],type:t.type,tenant:t.tenant,isMerged:!0}),r.add(n+1);continue}}i.push({rooms:[t.name],type:t.type,tenant:t.tenant,isMerged:!1})}return i.forEach(n=>{const t='您的房间'===n.type,o='空房间'===n.type,a='套间'===n.type,i='公共客厅'===n.type,r='健身房'===n.type,l='洗衣间'===n.type,s=i||r||l,d=!(a||t||o||s),c='未知'===n.tenant&&a;let g='';g=t?'your':o?'empty':i?'public-lounge':r?'public-gym':l?'public-laundry':d?'custom-functional':c?'bedroom vacant':'bedroom',n.isMerged&&(g+=' merged');const p='<user>'===n.tenant?'房东':'未知'===n.tenant?'':n.tenant;let m='🏠';t?m='👑':o?m='🔧':i?m='🛋️':r?m='💪':l?m='🧺':d&&(m='🏢');const u=n.isMerged?`${n.rooms[0]}-${n.rooms[1]}`:n.rooms[0];let f='';i?f='公共客厅':r?f='健身房':l?f='洗衣间':d&&(f=n.type),e+=`<div class="ngq-room-card ${g}" data-room="${n.rooms[0]}" data-room-type="${n.type}" data-room-tenant="${n.tenant}">`,e+=`<div class="ngq-room-name">${m} ${u}</div>`,e+=t?'<div class="ngq-room-occupant">🔑 房东自住</div>':o?'<div class="ngq-room-occupant">🔨 未装修</div>':s?`<div class="ngq-room-occupant">✨ ${f}</div>`:d?`<div class="ngq-room-occupant">🎨 ${f}</div>`:p?`<div class="ngq-room-occupant">👤 ${p}</div>`:'<div class="ngq-room-occupant">🏷️ 待出租</div>',e+='</div>'}),e+='</div></div>',e}(n,e)}),a+='</div>',a+='\n    <div class="ngq-card" style="margin-top:16px">\n      <div class="ngq-card-title">\n        <span>🏢</span>\n        <span>小区管理</span>\n      </div>\n      <div class="ngq-card-body">\n        <div class="ngq-management-actions">\n          <button class="ngq-btn" data-action="recruit">👤 招募新租客</button>\n          <button class="ngq-btn" data-action="buy-floor">🏗️ 购置新楼层</button>\n        </div>\n        <div class="ngq-management-actions" style="margin-top:12px">\n          <button class="ngq-btn" data-action="refresh">🔄 刷新数据</button>\n          <button class="ngq-btn" data-action="auto-refresh" id="auto-refresh-btn">⏱️ 自动刷新: 关</button>\n        </div>\n        <div style="margin-top:12px;padding:12px;background:rgba(255,107,157,0.1);border-radius:8px;font-size:13px;color:var(--apt-dim);line-height:1.5">\n          💡 提示：购置新楼层将同时建造4个公寓单元（如四楼：401/402/403/404）\n        </div>\n      </div>\n    </div>\n  ',a}(t);e.innerHTML=i,l||(!function(n){const t=n.getElementById('ngq-content');if(!t)return;t.addEventListener('click',t=>{const e=t.target.closest('.ngq-room-card');if(e){t.preventDefault(),t.stopPropagation();const o=e.getAttribute('data-room'),i=e.getAttribute('data-room-type'),r=e.getAttribute('data-room-tenant');return console.log('🖱️ 点击房间卡片:',{roomName:o,roomType:i,roomTenant:r}),console.log('🔍 roomCard HTML:',e.outerHTML.substring(0,200)),void(o?'空房间'===i?(console.log('✅ 检测到空房间，打开装修选择模态框'),function(n,t){console.log('🔍 openRenovateModal 被调用，传入的 roomName:',t,'类型:',typeof t);const e=n.getElementById('ngq-renovate-modal'),o=n.getElementById('ngq-renovate-room-info');if(!e||!o)return void console.error('❌ 找不到装修模态框元素');s=t,console.log('✅ 已设置 currentRenovatingRoom:',s),o.textContent=`选择要将 ${t} 装修为何种类型：`,e.classList.remove('hidden')}(n,o)):(console.log('✅ 打开房间详情模态框'),function(n,t,e,o){const i=n.getElementById('ngq-room-modal'),r=n.getElementById('ngq-room-modal-title'),l=n.getElementById('ngq-room-modal-body');if(!(i&&r&&l&&a))return;const s=a?.公寓?.房间列表?.[0]?.[t],g='您的房间'===e,p='公共客厅'===e,m='健身房'===e,u='洗衣间'===e,f=p||m||u;let v='🏠';g?v='👑':p?v='🛋️':m?v='💪':u&&(v='🧺');r.textContent=`${v} ${t}`;let b='';if(s){b+='<div style="margin-bottom:16px">',b+=`<div class="ngq-info-row"><span class="ngq-info-label">房间类型</span><span class="ngq-info-value">${e}</span></div>`;const n=s?.布局;if(n&&'object'==typeof n){const t=n.楼层||'未知',e=n.位置||'未知';b+=`<div class="ngq-info-row"><span class="ngq-info-label">所在楼层</span><span class="ngq-info-value">${t}</span></div>`,b+=`<div class="ngq-info-row"><span class="ngq-info-label">位置</span><span class="ngq-info-value">${'A区'===e?'🅰 A区':'B区'===e?'🅱 B区':'C区'===e?'🅲 C区':'D区'===e?'🅳 D区':e}</span></div>`}const t=c(s,'描述','');if(t&&(b+=`<div class="ngq-info-row" style="display:block"><span class="ngq-info-label">房间描述</span><div style="margin-top:6px;color:var(--apt-text);line-height:1.5">${t}</div></div>`),b+='</div>','套间'===e&&o&&'未知'!==o){const n=a?.租客列表?.[0]?.[o];if(n){b+='<div style="border-top:1px solid var(--apt-border);padding-top:16px;margin-top:8px">',b+='<div style="font-size:1.1em;font-weight:600;margin-bottom:12px;color:var(--apt-primary)">👤 租客信息</div>';const t=c(n,'年龄','-'),e=c(n,'职业','-'),a=c(n,'创作内容','-'),i=c(n,'外貌','-'),r=c(n,'性格','-'),l=parseInt(c(n,'好感度','0'))||0,s=parseInt(c(n,'性欲','0'))||0,d=c(n,'入住天数','0');b+=`<div class="ngq-info-row"><span class="ngq-info-label">姓名</span><span class="ngq-info-value">${o}</span></div>`,b+=`<div class="ngq-info-row"><span class="ngq-info-label">年龄</span><span class="ngq-info-value">${t}岁</span></div>`,b+=`<div class="ngq-info-row"><span class="ngq-info-label">职业</span><span class="ngq-info-value">📱 ${e}</span></div>`,b+=`<div class="ngq-info-row"><span class="ngq-info-label">创作内容</span><span class="ngq-info-value">✨ ${a}</span></div>`,b+='<div class="ngq-info-block">',b+='<span class="ngq-info-label">❤️ 好感度</span>',b+='<div class="ngq-progress-bar">',b+=`<div class="ngq-progress-fill favor" style="width:${l}%">${l}</div>`,b+='</div></div>',b+='<div class="ngq-info-block">',b+='<span class="ngq-info-label">🔥 性欲</span>',b+='<div class="ngq-progress-bar">',b+=`<div class="ngq-progress-fill lust" style="width:${s}%">${s}</div>`,b+='</div></div>',b+=`<div class="ngq-info-block"><span class="ngq-info-label">外貌特征</span><div class="ngq-info-value">${i}</div></div>`,b+=`<div class="ngq-info-block"><span class="ngq-info-label">性格</span><div class="ngq-info-value">${r}</div></div>`,b+=`<div class="ngq-info-block"><span class="ngq-info-label">当前状态</span><div class="ngq-info-value">${c(n,'状态','-')}</div></div>`,b+=`<div class="ngq-info-block"><span class="ngq-info-label">内心想法</span><div class="ngq-info-value">${c(n,'内心','-')}</div></div>`,b+=`<div class="ngq-info-row"><span class="ngq-info-label">入住天数</span><span class="ngq-info-value">📅 ${d}天</span></div>`,b+='</div>'}}else if('套间'===e)b+='<div style="text-align:center;padding:20px;color:var(--apt-dim)">🏠 该套间暂无租客入住</div>';else if(g)b+='<div style="text-align:center;padding:20px;color:var(--apt-dim)">👑 这是您的私人套间</div>';else if(f){const n='string'==typeof s?.描述?s.描述:'',t='string'==typeof s?.功能区?s.功能区:'';let o='var(--apt-primary)',a='✨';p?(o='#f59e0b',a='🛋️'):m?(o='#10b981',a='💪'):u&&(o='#0ea5e9',a='🧺'),b+='<div style="text-align:center;padding:20px;color:var(--apt-text)">',b+=`<div style="font-size:16px;font-weight:600;color:${o};margin-bottom:16px">${a} ${e}</div>`,n&&(b+=`<div style="margin-bottom:12px;font-size:14px;color:var(--apt-dim);line-height:1.6">${n}</div>`),t&&(b+=`<div style="font-size:13px;color:${o};margin-top:12px;padding:8px;background:rgba(255,255,255,0.05);border-radius:6px">🔧 ${t}</div>`),b+=`<div style="margin-top:16px;font-size:13px;color:var(--apt-dim);padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;border:1px dashed ${o}">✨ 免费对所有租客开放</div>`,b+='</div>'}}else b='<div class="ngq-empty"><div class="ngq-empty-icon">❓</div><div>房间数据不存在</div></div>';l.innerHTML=b;const q=n.getElementById('ngq-room-demolish-actions');if(q){!(g||['101','102','103','104','204','304'].includes(t)||'套间'===e&&'未知'!==o)?(q.style.display='flex',d=t):(q.style.display='none',d='')}i.classList.remove('hidden')}(n,o,i||'',r||'')):console.warn('⚠️ roomName 为空，无法打开模态框'))}}),t.addEventListener('click',t=>{const e=t.target;if(!e.matches('button[data-action]'))return;const o=e.getAttribute('data-action'),a=e.getAttribute('data-name');'favor-add'===o&&a?(t.preventDefault(),t.stopPropagation(),y(`_.add('租客列表[0].${a}.好感度[0]', 5); // 交互友好，略微提升好感`)):'recruit'===o?(t.preventDefault(),t.stopPropagation(),function(n){const t=n.getElementById('ngq-recruitment-modal'),e=n.getElementById('ngq-recruitment-keywords');t&&e&&(t.classList.remove('hidden'),e.value='',setTimeout(()=>{e.focus()},100))}(n)):'buy-floor'===o?(t.preventDefault(),t.stopPropagation(),y('购置新楼层（需同时建造4个公寓单元：01/02/03/04）')):'refresh'===o?(t.preventDefault(),t.stopPropagation(),p(n)):'auto-refresh'===o&&(t.preventDefault(),t.stopPropagation(),r?(clearInterval(r),r=null,e.textContent='⏱️ 自动刷新: 关'):(r=window.setInterval(()=>{p(n)},4e3),e.textContent='⏱️ 自动刷新: 开'))})}(n),l=!0,console.log('✅ 内容区事件已绑定（首次）'))}(n,e)}catch(t){console.error('❌ 加载数据出错:',t),m(n,'加载出错: '+t.message)}}function m(n,t){const e=n.getElementById('ngq-content');e&&(e.innerHTML=`\n      <div class="ngq-empty">\n        <div class="ngq-empty-icon">⚠️</div>\n        <div class="ngq-empty-text">${t}</div>\n      </div>\n    `)}function u(n){const t=n.getElementById('ngq-recruitment-modal');t&&t.classList.add('hidden')}function f(n){const t=n.getElementById('ngq-recruitment-keywords');if(t){const e=t.value.trim();if(!e)return void alert('请输入租客特征后再确认。');y(`招募一名符合以下特征的租客：${e}`),u(n)}}function v(n){const t=n.getElementById('ngq-room-modal');t&&(t.classList.add('hidden'),d='')}function b(n,t=!0){const e=n.getElementById('ngq-renovate-modal');e&&(e.classList.add('hidden'),t&&(s=''))}function q(n){const t=n.getElementById('ngq-functional-input-modal');t&&t.classList.add('hidden')}function x(n){if(console.log('🔍 confirmFunctionalRenovate 被调用'),console.log('🔍 currentRenovatingRoom:',s),!s)return void console.warn('⚠️ currentRenovatingRoom 为空，退出');const t=n.getElementById('ngq-functional-name'),e=n.getElementById('ngq-functional-purpose');console.log('🔍 找到的输入框:',{nameInput:t,purposeInput:e});const o=t?.value.trim()||'',a=e?.value.trim()||'';if(console.log('🔍 输入值:',{name:o,purpose:a}),!o)return alert('请输入房间名称'),void t?.focus();if(!a)return alert('请输入房间作用'),void e?.focus();const i=`将 ${s} 装修为功能性房间【${o}】，作用：${a}`;console.log('✅ 生成命令:',i),y(i),q(n),s=''}function y(n){try{const t=(parent.document||document).querySelector('#send_textarea');if(!t)throw new Error('未找到输入框');''!==t.value.trim()?t.value+='\n\n'+n:t.value=n,t.focus(),console.log('✅ 命令已填充到输入框')}catch(t){alert('未能自动找到输入框，请手动复制命令：\n\n'+n),console.error('填充命令失败:',t)}}!function n(t){'undefined'!=typeof jQuery||'undefined'!=typeof $?(console.log('✅ jQuery 已就绪'),t()):(console.log('⏳ 等待 jQuery...'),setTimeout(()=>n(t),100))}(()=>{$(()=>{console.log('✅ 开始初始化网红小区插件'),g()})}),console.log('✅ 网红小区插件脚本加载完成');const h=!0,w=t.d;export{w as __initialized__};
//# sourceMappingURL=index.js.map