# æ±Ÿç•”å¤œæ€»ä¼šçŠ¶æ€æ  - ä½¿ç”¨æŒ‡å—

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

- âœ… **ç¬¦åˆé…’é¦†åŠ©æ‰‹è§„èŒƒ**ï¼šä½¿ç”¨ TypeScript ç¼–å†™ï¼Œå®Œå…¨ç¬¦åˆé¡¹ç›®è§„èŒƒ
- âœ… **åŸç”Ÿå®ç°**ï¼šä¸ä¾èµ– Vue æ¡†æ¶ï¼Œä½¿ç”¨åŸç”Ÿ HTML + TypeScript
- âœ… **å¯æ‹–åŠ¨æŒ‰é’®**ï¼šæµ®åŠ¨æŒ‰é’®æ”¯æŒæ‹–åŠ¨ï¼Œä½ç½®è‡ªåŠ¨ä¿å­˜
- âœ… **å¯æ‹–åŠ¨é¢æ¿**ï¼šé€šè¿‡æ ‡é¢˜æ æ‹–åŠ¨æ•´ä¸ªé¢æ¿ï¼Œæ”¯æŒé¼ æ ‡å’Œè§¦å±æ“ä½œ
- âœ… **æ•°æ®å®æ—¶æ˜¾ç¤º**ï¼šä» MVU æ¡†æ¶è¯»å–æœ€æ–°æ•°æ®å¹¶å±•ç¤º
- âœ… **ç¾è§‚ç•Œé¢**ï¼šæ·±è‰²ä¸»é¢˜ï¼Œç¬¦åˆå¤œæ€»ä¼šé£æ ¼
- âœ… **å“åº”å¼è®¾è®¡**ï¼šå®Œç¾æ”¯æŒç§»åŠ¨ç«¯ã€å¹³æ¿å’Œæ¡Œé¢ç«¯
- âœ… **ç«–å±ä¼˜åŒ–**ï¼šç§»åŠ¨ç«¯ç«–å±æ¨¡å¼è‡ªåŠ¨å…¨å±æ˜¾ç¤º
- âœ… **è§¦å±å‹å¥½**ï¼šæ‰€æœ‰æ‹–åŠ¨æ“ä½œéƒ½æ”¯æŒè§¦æ‘¸å±

## ğŸ“¦ å®‰è£…æ­¥éª¤

### 1. æ„å»ºè„šæœ¬

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š

```bash
pnpm run build
```

è¿™å°†åœ¨ `dist/æ±Ÿç•”å¤œæ€»ä¼šçŠ¶æ€æ /` æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆæ‰“åŒ…åçš„æ–‡ä»¶ã€‚

### 2. å¯¼å…¥åˆ°é…’é¦†

1. æ‰“å¼€é…’é¦†åŠ©æ‰‹çš„**è„šæœ¬ç®¡ç†**ç•Œé¢
2. ç‚¹å‡» **å¯¼å…¥è„šæœ¬**
3. é€‰æ‹© `dist/æ±Ÿç•”å¤œæ€»ä¼šçŠ¶æ€æ /index.js` æ–‡ä»¶
4. ç»™è„šæœ¬å‘½åï¼ˆä¾‹å¦‚ï¼šæ±Ÿç•”å¤œæ€»ä¼š-çŠ¶æ€æ ï¼‰
5. å¯ç”¨è„šæœ¬

### 3. ä½¿ç”¨è„šæœ¬

å¯ç”¨è„šæœ¬åï¼Œæµè§ˆå™¨é¡µé¢å³ä¸‹è§’ä¼šå‡ºç°ä¸€ä¸ª ğŸŒ™ æŒ‰é’®ï¼š

#### ğŸŒ™ æµ®åŠ¨æŒ‰é’®æ“ä½œ

- **ç‚¹å‡»æŒ‰é’®**ï¼šæ‰“å¼€/å…³é—­çŠ¶æ€æ é¢æ¿
- **æ‹–åŠ¨æŒ‰é’®**ï¼šé•¿æŒ‰å¹¶æ‹–åŠ¨å¯ä»¥è°ƒæ•´æŒ‰é’®ä½ç½®ï¼Œä½ç½®ä¼šè‡ªåŠ¨ä¿å­˜
- **è§¦æ‘¸æ‹–åŠ¨**ï¼šç§»åŠ¨è®¾å¤‡ä¸Šå¯ä»¥é€šè¿‡è§¦æ‘¸æ‹–åŠ¨æŒ‰é’®

#### ğŸ“± é¢æ¿æ“ä½œ

- **æ‹–åŠ¨é¢æ¿**ï¼šç‚¹å‡»å¹¶æ‹–åŠ¨é¢æ¿æ ‡é¢˜æ ï¼ˆé¡¶éƒ¨æ·±ç²‰è‰²åŒºåŸŸï¼‰å¯ä»¥ç§»åŠ¨æ•´ä¸ªé¢æ¿
- **è§¦å±æ‹–åŠ¨**ï¼šç§»åŠ¨è®¾å¤‡ä¸Šæ”¯æŒè§¦æ‘¸æ‹–åŠ¨é¢æ¿ï¼ˆæ¨ªå±æ¨¡å¼ï¼‰
- **å…³é—­é¢æ¿**ï¼šç‚¹å‡»å³ä¸Šè§’çš„ Ã— æŒ‰é’®å…³é—­é¢æ¿
- **æŸ¥çœ‹æ•°æ®**ï¼šé¢æ¿ä¸­ä¼šæ˜¾ç¤ºå¤œæ€»ä¼šçš„ç»è¥çŠ¶å†µã€åŸ¹å…»å¯¹è±¡ç­‰ä¿¡æ¯
- **è‡ªåŠ¨ä¿å­˜ä½ç½®**ï¼šé¢æ¿ä½ç½®ä¼šè‡ªåŠ¨ä¿å­˜ï¼Œä¸‹æ¬¡æ‰“å¼€æ—¶æ¢å¤

#### ğŸ“ å±å¹•é€‚é…

- **æ¡Œé¢ç«¯**ï¼šé¢æ¿å¯è‡ªç”±æ‹–åŠ¨ï¼Œé»˜è®¤å±…ä¸­æ˜¾ç¤º
- **å¹³æ¿æ¨ªå±**ï¼šé¢æ¿å¯æ‹–åŠ¨ï¼Œå®½åº¦è‡ªé€‚åº”
- **æ‰‹æœºæ¨ªå±**ï¼šé¢æ¿å¯æ‹–åŠ¨ï¼Œæ˜¾ç¤ºå®Œæ•´å†…å®¹
- **æ‰‹æœºç«–å±**ï¼šé¢æ¿è‡ªåŠ¨å…¨å±æ˜¾ç¤ºï¼Œä¸å¯æ‹–åŠ¨ï¼ˆè·å¾—æœ€ä½³é˜…è¯»ä½“éªŒï¼‰

## ğŸ“Š æ•°æ®ç»“æ„è¦æ±‚

è„šæœ¬ä» MVU æ¡†æ¶è¯»å–æœ€æ–°æ¶ˆæ¯æ¥¼å±‚çš„ `stat_data`ï¼ŒæœŸæœ›çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š

```yaml
æ—¶é—´ä¿¡æ¯:
  å½“å‰æ—¥æœŸ: "2025å¹´10æœˆ25æ—¥"
  å½“å‰æ—¶é—´: "20:30"
  è¥ä¸šçŠ¶æ€: "è¥ä¸šä¸­"

åœ°ç‚¹ä¿¡æ¯:
  å½“å‰ä½ç½®: "æ±Ÿç•”å¤œæ€»ä¼š"

å¤œæ€»ä¼šç»è¥:
  æœ¬æœˆè¥æ”¶: "500000"
  åœ¨èŒå‘˜å·¥æ•°: "30"
  VIPå®¢æˆ·æ•°: "15"
  å¾…å¤„ç†è®¢å•: []

å·¥åŠåŸ¹å…»å¯¹è±¡:
  å½“å‰åŸ¹å…»äººæ•°: "2"
  åŸ¹å…»åˆ—è¡¨:
    - å§“å: "å¼ ä¸‰"
      ç¼–å·: "001"
      åŸºæœ¬ä¿¡æ¯:
        åŸ¹å…»å¤©æ•°: "10"
      å®šåˆ¶ä¿¡æ¯:
        ç›®æ ‡å½¢è±¡: "é«˜ç«¯ååª›"
        å¯¹åº”è®¢å•: "VIP-001"
      å½“å‰çŠ¶æ€: "åŸºç¡€åŸ¹è®­ä¸­"
      åŸ¹å…»è¿›åº¦:
        ç¤¾äº¤ç¤¼ä»ª: "60"
        æ‰è‰ºåŸ¹å…»: "45"
        æ€§çˆ±æŠ€å·§: "30"
        å½¢ä½“æ”¹é€ : "40"
        ç»¼åˆå®Œæˆåº¦: "45"

å·²å½’æ¡£è‰ºäºº:
  æ€»å½’æ¡£æ•°: "5"
  æ¡£æ¡ˆåˆ—è¡¨:
    - è‰ºå: "å°èŠ±"
      ç±»å‹: "é™ªé…’å°å§"
      åŸ¹å…»å‘¨æœŸ: "30å¤©"
      æœ€ç»ˆè¯„çº§: "Açº§"

å½“å‰åª’ä½“æ’­æ”¾:
  æ­£åœ¨æ’­æ”¾: "é’¢ç´æ›² - å¤œçš„é’¢ç´æ›²äº”"
  æ’­æ”¾è¿›åº¦: "45%"
```

## ğŸ”§ æŠ€æœ¯å®ç°

### é¡¹ç›®ç»“æ„

```
src/æ±Ÿç•”å¤œæ€»ä¼šçŠ¶æ€æ /
â”œâ”€â”€ index.ts           # ä¸»å…¥å£æ–‡ä»¶ï¼ˆTypeScriptï¼‰
â”œâ”€â”€ README.md          # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ä½¿ç”¨æŒ‡å—.md        # æœ¬æ–‡æ¡£
â””â”€â”€ å‚è€ƒ.js            # å‚è€ƒå®ç°ï¼ˆæŒä¸Šå…¬å¯“ï¼‰
```

### æ ¸å¿ƒç‰¹æ€§

1. **æ—  Vue ä¾èµ–**ï¼šä½¿ç”¨åŸç”Ÿ HTML + TypeScriptï¼Œæ‰“åŒ…åä½“ç§¯å°ï¼ˆä»… 20.5 KBï¼‰

2. **æ­£ç¡®çš„åˆå§‹åŒ–æ–¹å¼**ï¼š

```typescript
// âœ… ä½¿ç”¨ waitForJQuery ç­‰å¾…ä¾èµ–åŠ è½½
waitForJQuery(() => {
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeNightclubPlugin);
  } else {
    initializeNightclubPlugin();
  }
});
```

3. **ç›®æ ‡æ–‡æ¡£å¤„ç†**ï¼š

```typescript
// æ‰€æœ‰ DOM æ“ä½œéƒ½åœ¨ä¸»æ–‡æ¡£ä¸Š
const targetDoc = window.top ? window.top.document : document;
```

4. **æ ·å¼å’Œ HTML æ³¨å…¥**ï¼š

```typescript
// ç›´æ¥æ³¨å…¥åˆ°ä¸»æ–‡æ¡£
targetDoc.head.insertAdjacentHTML('beforeend', styles);
targetDoc.body.insertAdjacentHTML('beforeend', html);
```

5. **MVU æ•°æ®è¯»å–**ï¼š

```typescript
// ä» MVU æ¡†æ¶è·å–æœ€æ–°æ¶ˆæ¯çš„æ•°æ®
const mvuResult = Mvu.getMvuData({
  type: 'message',
  message_id: 'latest',
});
const data = mvuResult?.stat_data;
```

6. **é¢æ¿æ‹–åŠ¨åŠŸèƒ½**ï¼š

```typescript
// æ”¯æŒé¼ æ ‡å’Œè§¦æ‘¸æ‹–åŠ¨
function initializePanelDrag(targetDoc: Document) {
  // åœ¨æ ‡é¢˜æ ä¸Šç»‘å®šæ‹–åŠ¨äº‹ä»¶
  $(header).on('mousedown.nightclub-panel touchstart.nightclub-panel', ...);
  
  // ç§»åŠ¨ç«¯ç«–å±è‡ªåŠ¨å…¨å±ï¼Œä¸å…è®¸æ‹–åŠ¨
  const isPortraitMobile = window.innerWidth <= 480 && window.innerWidth < window.innerHeight;
  if (isPortraitMobile) return false;
  
  // ä½ç½®ä¿å­˜åˆ° localStorage
  localStorage.setItem('nightclub-panel-position', JSON.stringify(position));
}
```

7. **å“åº”å¼å¸ƒå±€**ï¼š

- ç§»åŠ¨ç«¯é€‚é…ï¼š`@media (max-width: 768px)`
- ç«–å±ä¼˜åŒ–ï¼ˆå…¨å±æ˜¾ç¤ºï¼‰ï¼š`@media (max-width: 480px) and (orientation: portrait)`
- æ¨ªå±ä¼˜åŒ–ï¼š`@media (max-height: 600px) and (orientation: landscape)`

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šæŒ‰é’®æ— æ³•æ‹–åŠ¨æˆ–ç‚¹å‡»

**å¯èƒ½åŸå› **ï¼š

- å…¶ä»–æ’ä»¶æˆ–å…ƒç´ é®æŒ¡äº†æŒ‰é’®
- æµè§ˆå™¨æ‰©å±•å¹²æ‰°äº†äº‹ä»¶

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰æŠ¥é”™
2. å°è¯•ç¦ç”¨å…¶ä»–æµè§ˆå™¨æ‰©å±•
3. åˆ·æ–°é¡µé¢é‡æ–°åŠ è½½è„šæœ¬

### é—®é¢˜ï¼šé¢æ¿æ˜¾ç¤º"MVU æ¡†æ¶æœªåŠ è½½"

**å¯èƒ½åŸå› **ï¼š

- MVU æ¡†æ¶è„šæœ¬æœªå¯ç”¨
- MVU æ¡†æ¶åŠ è½½é¡ºåºåœ¨çŠ¶æ€æ ä¹‹å

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. ç¡®ä¿ MVU æ¡†æ¶è„šæœ¬å·²å¯ç”¨
2. åœ¨é…’é¦†åŠ©æ‰‹ä¸­è°ƒæ•´è„šæœ¬åŠ è½½é¡ºåºï¼Œè®© MVU æ¡†æ¶å…ˆåŠ è½½
3. åˆ·æ–°é¡µé¢é‡æ–°åŠ è½½

### é—®é¢˜ï¼šé¢æ¿æ˜¾ç¤º"æœªèƒ½åŠ è½½æ•°æ®"

**å¯èƒ½åŸå› **ï¼š

- å½“å‰æ¶ˆæ¯æ¥¼å±‚æ²¡æœ‰ MVU æ•°æ®
- æ•°æ®ç»“æ„ä¸ç¬¦åˆé¢„æœŸ

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. ç¡®ä¿è§’è‰²å¡ä½¿ç”¨äº† MVU å˜é‡
2. æ£€æŸ¥æ•°æ®ç»“æ„æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼ˆè§ä¸Šæ–¹"æ•°æ®ç»“æ„è¦æ±‚"ï¼‰
3. åœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯

### é—®é¢˜ï¼šé¢æ¿æ— æ³•æ‹–åŠ¨

**å¯èƒ½åŸå› **ï¼š

- åœ¨ç§»åŠ¨ç«¯ç«–å±æ¨¡å¼ä¸‹ï¼ˆé¢æ¿è‡ªåŠ¨å…¨å±ï¼Œä¸å¯æ‹–åŠ¨ï¼‰
- ç‚¹å‡»äº†å…³é—­æŒ‰é’®åŒºåŸŸ
- æµè§ˆå™¨æ‰©å±•å¹²æ‰°äº†æ‹–åŠ¨äº‹ä»¶

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. ç¡®è®¤ä¸æ˜¯åœ¨ç§»åŠ¨ç«¯ç«–å±æ¨¡å¼ï¼ˆå®½åº¦ â‰¤ 480pxï¼‰
2. ç¡®ä¿ç‚¹å‡»çš„æ˜¯æ ‡é¢˜æ åŒºåŸŸï¼Œè€Œä¸æ˜¯å…³é—­æŒ‰é’®
3. å°è¯•åˆ·æ–°é¡µé¢æˆ–ç¦ç”¨å…¶ä»–æµè§ˆå™¨æ‰©å±•
4. åœ¨æ¡Œé¢ç«¯æˆ–æ¨ªå±æ¨¡å¼ä¸‹æµ‹è¯•
5. åœ¨æ§åˆ¶å°æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—

## ğŸ“ å¼€å‘è¯´æ˜

### ä¿®æ”¹è„šæœ¬

å¦‚æœéœ€è¦ä¿®æ”¹è„šæœ¬åŠŸèƒ½ï¼š

1. ç¼–è¾‘ `src/æ±Ÿç•”å¤œæ€»ä¼šçŠ¶æ€æ /index.ts`
2. è¿è¡Œ `pnpm run build` é‡æ–°æ„å»º
3. åœ¨é…’é¦†ä¸­é‡æ–°å¯¼å…¥ `dist/æ±Ÿç•”å¤œæ€»ä¼šçŠ¶æ€æ /index.js`

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—**ï¼š
   - æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
   - æŸ¥çœ‹ä»¥ "ğŸŒ™" å¼€å¤´çš„æ—¥å¿—

2. **æ£€æŸ¥æ•°æ®**ï¼š
   - åœ¨æ§åˆ¶å°è¾“å…¥ `Mvu.getMvuData({ type: 'message', message_id: 'latest' })`
   - æŸ¥çœ‹è¿”å›çš„æ•°æ®ç»“æ„

3. **æ¸…é™¤æŒ‰é’®ä½ç½®**ï¼š
   - åœ¨æ§åˆ¶å°è¾“å…¥ `localStorage.removeItem('nightclub-btn-position')`
   - åˆ·æ–°é¡µé¢ï¼ŒæŒ‰é’®ä¼šæ¢å¤åˆ°é»˜è®¤ä½ç½®

4. **æ¸…é™¤é¢æ¿ä½ç½®**ï¼š
   - åœ¨æ§åˆ¶å°è¾“å…¥ `localStorage.removeItem('nightclub-panel-position')`
   - åˆ·æ–°é¡µé¢ï¼Œé¢æ¿ä¼šæ¢å¤åˆ°å±…ä¸­ä½ç½®

5. **æµ‹è¯•æ‹–åŠ¨åŠŸèƒ½**ï¼š
   - æ£€æŸ¥æ˜¯å¦åœ¨ç«–å±æ¨¡å¼ï¼š`window.innerWidth <= 480 && window.innerWidth < window.innerHeight`
   - æŸ¥çœ‹æ‹–åŠ¨çŠ¶æ€ï¼šé¢æ¿æ‹–åŠ¨æ—¶æ ‡é¢˜æ ä¼šæ˜¾ç¤º `cursor: grabbing`

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº [é…’é¦†åŠ©æ‰‹æ¨¡æ¿](https://github.com/...) å¼€å‘ï¼Œéµå¾ªç›¸åŒçš„è®¸å¯è¯ã€‚

## ğŸ™ è‡´è°¢

- å‚è€ƒäº†[æŒä¸Šå…¬å¯“]æ’ä»¶çš„å®ç°æ–¹å¼
- åŸºäº [é…’é¦†åŠ©æ‰‹](https://n0vi028.github.io/JS-Slash-Runner-Doc/) æ¡†æ¶
- ä½¿ç”¨ [MVU å˜é‡æ¡†æ¶](https://...) è¿›è¡Œæ•°æ®ç®¡ç†
