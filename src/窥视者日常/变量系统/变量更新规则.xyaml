# 变量更新规则

## 总则
- 所有变量以 `世界 / 玩家 / 角色 / 李强 / 摄像头 / 设备 / 仓库` 七个区块维护。
- 每回合必须根据剧情推导：谁在场、发生了什么、是否留下痕迹，然后决定哪些字段需要更新。
- 更新顺序建议：时间 → 玩家 → 角色 → 李强 → 摄像头/设备 → 仓库。

---

## 1. 世界（时间与环境）
- **时间推进**：一次普通互动默认前进 5-15 分钟；若剧情为长时间监视或整夜潜伏，可一次推进 30-120 分钟。
- **日期/星期**：若时间越过 24:00，日期 +1，星期顺延。
- **天气**：根据描写或剧情事件（下雨、暴风、晴朗）调整，可作为潜入/摄像成功率的背景条件。

---

## 2. 玩家
- `玩家.位置`：进入哪间房、走廊或公共区域都要即时同步；若回到 203 或监控室，再改回“203”或“监控室”。

---

## 3. 角色（所有女性角色共用结构）
每个角色拥有：`位置 / 状态 / 心情 / 好感度 / 警戒度 / 身体敏感度 / 意识值`

### 3.1 位置与状态
- 参考《租客动线》：若剧情时间段内角色应在教室或外出，需把 `位置` 改为“学校”“外出”等，并把 `状态` 改为对应行为。
- 当玩家干预导致动线偏离（例如被强行带回房间），应立即写入新的 `状态` 说明异常。

### 3.2 心情
- 受到惊吓、疼痛或被羞辱 → “紧张”“恐惧”“崩溃”。
- 被温柔安抚、获得礼物 → “放松”“开心”。
- 长期重复某种刺激，可出现“麻木”“沉迷”等描述。

### 3.3 好感度
- 正向行为（解困、送礼、提供技术支持）可 +1~5。
- 负向行为（强迫、谎言曝光）可 -1~-10。
- 极端时刻（救命之恩或重大背叛）可一次 ±15。

### 3.4 警戒度
- 不同来源叠加：
  - 留下痕迹/噪声：+5~15
  - 发现身体异常（醒来后酸痛、液体残留）：+10~20
  - 长期平静 + 无异常：每 3 天 -5
- **阈值**：
  - >40：开始更换门锁、安装简易报警
  - >70：考虑报警或搬离

### 3.5 身体敏感度
- 轻度接触（抚摸、掀衣）：+1
- 深度刺激（口交、指交）：+3
- 完全性行为：+5 或更高
- >30：清醒时容易出现不自觉反应
- >60：频繁春梦，对房东的亲近行为容易误读
- >90：高度依赖，几乎任何触碰都会引发强烈反应

### 3.6 意识值
- 100：完全清醒
- 60-80：微醺/困意
- 30-60：半睡半醒
- <30：昏迷/深睡，可随意操控
- 影响因素：
  - 自然睡眠：每 30 分钟 -10，醒来后 +40~60
  - 安眠药/气体：迅速降到 10-20，持续 4~6 小时
  - 惊吓、疼痛：可瞬间 +10~30

---

## 4. 李强（独立角色）
- 仅保留 `位置` 与 `警戒度`。
- 周一至周四默认 `位置 = 港口宿舍`；周五晚至周日晚改为 `401`（或“在家”）。
- 当王艳/女儿们出现异常被他察觉，或摄像头/设备暴露 → `警戒度` +10~25。
- >60：开始搜索房间、安装自制摄像头；>90：正面质问玩家或报警。

---

## 5. 摄像头
- 每个条目包含 `安装位置`、`暴露度`、`摄像内容`。
- `暴露度` 初始为 0：每次被注视、碰触、遮挡时 +1~3。
- 当暴露度 >5：租客可能讨论“屋里有摄像头”；>8：有被拆除风险，可在剧情中触发摄像头失效并删除该条目。
- `摄像内容` 仅在玩家调用画面时写入，内容可在剧情结束后置空。

---

## 6. 设备
- 每个设备包含 `安装位置`、`状态`、`作用`。
- 排风口使用逻辑：
  - 启动 → `状态 = 释放中`，可在 `<UpdateVariable>` 中注明持续时长。
  - 释放结束 → `状态 = 冷却` 或 `待命`。
  - 若租客闻到异味或感到不适，应相应增加其 `警戒度`，并视情况提升摄像头暴露度。
- 未来可加入“微型录音器”“地板压力感应”等设备，保持相同结构。

---

## 7. 仓库
- 每个道具记录 `数量` 与 `作用`。
- 消耗类：使用一次就 `_.add('仓库.道具.数量', -1)`；数量为 0 可 `_.remove`。
- 新增道具需明确来源（如黑市购买、上线寄送），再 `_.insert`。
- 可根据剧情增加更多描述性作用（例如“伪造文书”“一次性锁孔模具”）。

---

## 使用提示
1. 先判断是否要推进时间；若推进导致动线变化，先改 `角色.*.位置/状态`。
2. 处理玩家行为：位置 → 被影响的角色 → 摄像头/设备。
3. 最后再决定是否更新仓库或新增标记（如新增 `角色.林小鹿.心情 = '戒心重重'`）。
4. 如果没有变量需要改动，可省略 `<UpdateVariable>`，但需在回复中说明“无需变量更新”。
