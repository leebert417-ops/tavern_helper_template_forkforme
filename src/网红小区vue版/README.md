# ç½‘çº¢å°åŒº Vue ç‰ˆ

åŸºäº Vue 3 + TypeScript + Pinia çš„æ¨¡å—åŒ–é‡æ„ç‰ˆæœ¬ã€‚

## ğŸ‰ é‡æ„å®Œæˆ

ç›®å‰ï¼Œä»åŸç‰ˆå•æ–‡ä»¶è„šæœ¬åˆ° Vue æ¨¡å—åŒ–æ¶æ„çš„é‡æ„å·¥ä½œå·²å…¨é¢å®Œæˆã€‚æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å‡å·²å®ç°ï¼Œä¸”ä»£ç ç»“æ„å¾—åˆ°äº†æå¤§çš„ä¼˜åŒ–ï¼Œæ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

## ğŸ› Bug ä¿®å¤

åœ¨é‡æ„å’Œæµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œä¿®å¤äº†ä»¥ä¸‹å…³é”®é—®é¢˜ï¼š

1.  **æ ·å¼æ³¨å…¥é—®é¢˜**ï¼šè§£å†³äº†å›  `style-loader` åœ¨ SillyTavern çš„ iframe ç¯å¢ƒä¸­æ— æ³•æ­£ç¡®æ³¨å…¥æ ·å¼çš„é—®é¢˜ã€‚é€šè¿‡åˆ›å»ºç‹¬ç«‹çš„ CSS æ–‡ä»¶ï¼Œå¹¶æ‰‹åŠ¨å°†æ‰€æœ‰æ ·å¼åˆå¹¶ã€æ³¨å…¥åˆ°é¡¶å±‚ `window` çš„æ–¹æ¡ˆï¼Œç¡®ä¿äº† UI çš„æ­£ç¡®æ˜¾ç¤ºã€‚
2.  **æ ·å¼å†²çªé—®é¢˜**ï¼šä¸ºé¿å…ä¸å…¶ä»–è„šæœ¬æˆ–æ’ä»¶çš„æ ·å¼å†²çªï¼Œä¸ºæœ¬é¡¹ç›®ä¸­çš„ç»å¤§éƒ¨åˆ† CSS è§„åˆ™æ·»åŠ äº† `#ngq-vue-app` çš„å‘½åç©ºé—´å‰ç¼€ï¼Œå®ç°äº†æ ·å¼éš”ç¦»ã€‚
3.  **æ‹–åŠ¨/ç‚¹å‡»å¤±æ•ˆé—®é¢˜**ï¼šé‡æ„äº† `useDrag.ts` æ‹–åŠ¨ç»„åˆå¼å‡½æ•°ï¼Œä½¿å…¶ä¸å†ç›´æ¥æ“ä½œ DOMï¼Œè€Œæ˜¯é€šè¿‡æ›´æ–° Vue çš„å“åº”å¼æ•°æ®æ¥é©±åŠ¨ä½ç½®å˜åŒ–ï¼Œå½»åº•è§£å†³äº†å›  DOM ä¸ Vue çŠ¶æ€ç«äº‰è€Œå¯¼è‡´çš„æ‹–åŠ¨å¼‚å¸¸å’Œç‚¹å‡»å¤±æ•ˆçš„ bugã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/ç½‘çº¢å°åŒºvueç‰ˆ/
â”œâ”€â”€ index.ts                          # âœ… ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ App.vue                           # âœ… æ ¹ç»„ä»¶
â”œâ”€â”€ components/                       # âœ… ç»„ä»¶ç›®å½•
â”‚   â”œâ”€â”€ ToggleButton.vue             # âœ… æ‹–åŠ¨æŒ‰é’®ç»„ä»¶
â”‚   â”œâ”€â”€ MainPanel.vue                # âœ… ä¸»é¢æ¿å®¹å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ FloorView.vue                # âœ… æ¥¼å±‚è§†å›¾ç»„ä»¶
â”‚   â”œâ”€â”€ RoomCard.vue                 # âœ… æˆ¿é—´å¡ç‰‡ç»„ä»¶
â”‚   â”œâ”€â”€ ManagementActions.vue        # âœ… ç®¡ç†æ“ä½œæŒ‰é’®ç»„ä»¶
â”‚   â””â”€â”€ modals/                      # âœ… æ¨¡æ€æ¡†ç»„ä»¶ç›®å½•
â”‚       â”œâ”€â”€ BaseModal.vue            # âœ… åŸºç¡€æ¨¡æ€æ¡†
â”‚       â”œâ”€â”€ RoomModal.vue            # âœ… æˆ¿é—´è¯¦æƒ…æ¨¡æ€æ¡†
â”‚       â”œâ”€â”€ RecruitmentModal.vue     # âœ… æ‹›å‹Ÿç§Ÿå®¢æ¨¡æ€æ¡†
â”‚       â”œâ”€â”€ RenovateModal.vue        # âœ… è£…ä¿®é€‰æ‹©æ¨¡æ€æ¡†
â”‚       â””â”€â”€ FunctionalInputModal.vue # âœ… åŠŸèƒ½æ€§æˆ¿é—´è¾“å…¥æ¨¡æ€æ¡†
â”œâ”€â”€ composables/                      # âœ… ç»„åˆå¼å‡½æ•°ç›®å½•
â”‚   â”œâ”€â”€ useDrag.ts                   # âœ… æ‹–åŠ¨åŠŸèƒ½ Hook
â”‚   â”œâ”€â”€ useMVUData.ts                # âœ… MVU æ•°æ®åŠ è½½ Hook
â”‚   â”œâ”€â”€ usePosition.ts               # âœ… ä½ç½®ä¿å­˜/æ¢å¤ Hook
â”‚   â””â”€â”€ useAutoRefresh.ts            # âœ… è‡ªåŠ¨åˆ·æ–° Hook
â”œâ”€â”€ stores/                           # âœ… Pinia çŠ¶æ€ç®¡ç†ç›®å½•
â”‚   â”œâ”€â”€ apartment.ts                 # âœ… å…¬å¯“æ•°æ® Store
â”‚   â”œâ”€â”€ ui.ts                        # âœ… UI çŠ¶æ€ Store
â”‚   â””â”€â”€ settings.ts                  # âœ… è®¾ç½® Store
â”œâ”€â”€ types/                            # âœ… TypeScript ç±»å‹å®šä¹‰ç›®å½•
â”‚   â””â”€â”€ index.ts                     # âœ… ç±»å‹å®šä¹‰æ–‡ä»¶
â”œâ”€â”€ styles/                           # âœ… æ ·å¼æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ variables.css                # âœ… CSS å˜é‡å®šä¹‰
â”‚   â”œâ”€â”€ common.css                   # âœ… é€šç”¨æ ·å¼
â”‚   â””â”€â”€ animations.css               # âœ… åŠ¨ç”»æ ·å¼
â”œâ”€â”€ utils/                            # âœ… å·¥å…·å‡½æ•°ç›®å½•
â”‚   â”œâ”€â”€ mvuHelper.ts                 # âœ… MVU æ•°æ®å¤„ç†å·¥å…·
â”‚   â””â”€â”€ commandHelper.ts             # âœ… å‘½ä»¤å¡«å……å·¥å…·
â”œâ”€â”€ to_do.md                          # âœ… ä»»åŠ¡æ¸…å•
â””â”€â”€ README.md                         # âœ… é¡¹ç›®è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰
```

## âœ… å·²å®Œæˆ

### é˜¶æ®µ 1ï¼šåŸºç¡€æ¶æ„æ­å»º âœ…

- [x] **ç±»å‹å®šä¹‰** (`types/index.ts`)
- [x] **å·¥å…·å‡½æ•°** (`utils/`)
- [x] **æ ·å¼æ–‡ä»¶** (`styles/`)

### é˜¶æ®µ 2ï¼šçŠ¶æ€ç®¡ç†ï¼ˆPinia Storesï¼‰ âœ…

- [x] **å…¬å¯“æ•°æ® Store** (`stores/apartment.ts`)
- [x] **UI çŠ¶æ€ Store** (`stores/ui.ts`)
- [x] **è®¾ç½® Store** (`stores/settings.ts`)

### é˜¶æ®µ 3ï¼šç»„åˆå¼å‡½æ•°ï¼ˆComposablesï¼‰ âœ…

- [x] **æ‹–åŠ¨åŠŸèƒ½** (`composables/useDrag.ts`)
- [x] **MVU æ•°æ®åŠ è½½** (`composables/useMVUData.ts`)
- [x] **ä½ç½®ä¿å­˜/æ¢å¤** (`composables/usePosition.ts`)
- [x] **è‡ªåŠ¨åˆ·æ–°** (`composables/useAutoRefresh.ts`)

### é˜¶æ®µ 4ï¼šæ ¸å¿ƒç»„ä»¶ âœ…

- [x] `components/MainPanel.vue` - ä¸»é¢æ¿
- [x] `components/FloorView.vue` - æ¥¼å±‚è§†å›¾
- [x] `components/RoomCard.vue` - æˆ¿é—´å¡ç‰‡
- [x] `components/ManagementActions.vue` - ç®¡ç†æ“ä½œ

### é˜¶æ®µ 5ï¼šæ¨¡æ€æ¡†ç»„ä»¶ âœ…

- [x] `components/modals/BaseModal.vue` - åŸºç¡€æ¨¡æ€æ¡†
- [x] `components/modals/RoomModal.vue` - æˆ¿é—´è¯¦æƒ…
- [x] `components/modals/RecruitmentModal.vue` - æ‹›å‹Ÿç§Ÿå®¢
- [x] `components/modals/RenovateModal.vue` - è£…ä¿®é€‰æ‹©
- [x] `components/modals/FunctionalInputModal.vue` - åŠŸèƒ½æ€§æˆ¿é—´è¾“å…¥

### é˜¶æ®µ 6ï¼šæ ¹ç»„ä»¶å’Œå…¥å£ âœ…

- [x] `App.vue` - æ ¹ç»„ä»¶ï¼ˆç§»é™¤æµ‹è¯•ä»£ç ï¼‰
- [x] `index.ts` - å…¥å£æ–‡ä»¶ï¼ˆé›†æˆæ ·å¼æ³¨å…¥ï¼‰

## ğŸš€ ä¸‹ä¸€æ­¥

ğŸ‰ **å…¨éƒ¨å®Œæˆï¼** ğŸ‰

æ‰€æœ‰è®¡åˆ’å†…çš„é‡æ„ä»»åŠ¡å‡å·²å®Œæˆã€‚

## ğŸ¯ æŠ€æœ¯æ ˆ

- **Vue 3** - ä½¿ç”¨ Composition API
- **TypeScript** - å®Œæ•´ç±»å‹æ”¯æŒ
- **Pinia** - çŠ¶æ€ç®¡ç†
- **VueUse** - ç»„åˆå¼å·¥å…·åº“ï¼ˆè‡ªåŠ¨å¯¼å…¥ï¼‰
- **CSS3** - æ ·å¼ï¼ˆæ”¯æŒ SCSSï¼‰

## ğŸ“š å¼€å‘è§„èŒƒ

### å‘½åè§„èŒƒ

- **ç»„ä»¶æ–‡ä»¶**ï¼šPascalCaseï¼ˆå¦‚ `ToggleButton.vue`ï¼‰
- **ç»„åˆå¼å‡½æ•°**ï¼šuse å‰ç¼€ + camelCaseï¼ˆå¦‚ `useDrag.ts`ï¼‰
- **Store æ–‡ä»¶**ï¼šcamelCaseï¼ˆå¦‚ `apartment.ts`ï¼‰
- **å·¥å…·å‡½æ•°**ï¼šcamelCaseï¼ˆå¦‚ `mvuHelper.ts`ï¼‰
- **CSS ç±»å**ï¼škebab-caseï¼Œngq å‰ç¼€ï¼ˆå¦‚ `.ngq-toggle-btn`ï¼‰
- **CSS å˜é‡**ï¼škebab-caseï¼Œapt å‰ç¼€ï¼ˆå¦‚ `--apt-primary`ï¼‰

### ä»£ç é£æ ¼

- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- ä¼˜å…ˆä½¿ç”¨ Composition API
- ç»„ä»¶ä½¿ç”¨ `<script setup>` è¯­æ³•
- æ ·å¼ä½¿ç”¨ç‹¬ç«‹çš„ `.css` æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ `styles.ts` ç»Ÿä¸€æ³¨å…¥
- æ·»åŠ  JSDoc æ³¨é‡Š

### Git æäº¤è§„èŒƒ

- `feat:` æ–°åŠŸèƒ½
- `fix:` ä¿®å¤ bug
- `refactor:` é‡æ„
- `style:` æ ·å¼è°ƒæ•´
- `docs:` æ–‡æ¡£æ›´æ–°
- `chore:` æ„å»º/å·¥å…·å˜åŠ¨

## ğŸ”§ å¼€å‘å‘½ä»¤

```bash
# å¼€å‘æ¨¡å¼ï¼ˆå¸¦çƒ­é‡è½½ï¼‰
npm run dev

# ç”Ÿäº§æ„å»º
npm run build

# ç±»å‹æ£€æŸ¥
npm run type-check
```

## ğŸ“– å‚è€ƒèµ„æ–™

- [Vue 3 å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Pinia å®˜æ–¹æ–‡æ¡£](https://pinia.vuejs.org/)
- [VueUse æ–‡æ¡£](https://vueuse.org/)
- [TypeScript å®˜æ–¹æ–‡æ¡£](https://www.typescriptlang.org/)

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **MVU æ•°æ®æ ¼å¼**ï¼šæ³¨æ„ MVU æ¡†æ¶çš„æ•°ç»„åŒ…è£…æ ¼å¼ `[value]`
2. **å…¨å±€æ³¨å…¥**ï¼šç»„ä»¶æŒ‚è½½åˆ° `window.top.document.body`
3. **äº‹ä»¶æ¸…ç†**ï¼šç»„ä»¶å¸è½½æ—¶æ¸…ç†æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨
4. **ä½ç½®ä¿å­˜**ï¼šä½¿ç”¨ localStorage æŒä¹…åŒ–æŒ‰é’®å’Œé¢æ¿ä½ç½®
5. **æ‹–åŠ¨æ£€æµ‹**ï¼šç§»åŠ¨è·ç¦» < 5px è§†ä¸ºç‚¹å‡»ï¼Œå¦åˆ™è§†ä¸ºæ‹–åŠ¨

## ğŸ“„ License

MIT

